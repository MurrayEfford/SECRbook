<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Spatially Explicit Capture–Recapture - 5&nbsp; Special topics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06-assumptions.html" rel="next">
<link href="./04-theory-area-search.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-theory.html">Theory</a></li><li class="breadcrumb-item"><a href="./05-theory-special-topics.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Special topics</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Spatially Explicit Capture–Recapture</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/MurrayEfford/SECRbook" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Foreword</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Basics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Concepts and terminology</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-example.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Simple example</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Theory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Likelihood-based SECR</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-theory-area-search.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Area search</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-theory-special-topics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Special topics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Performance</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Assumptions and robustness</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-validation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Empirical validation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-studydesign.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Study design</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Practice</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-secr-package.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">R package secr</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-detection-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Detection model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-density-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Density model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-habitat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Habitat mask</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-fittedmodels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Working with fitted models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-multisession.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Multiple sessions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-finite-mixtures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Individual heterogeneity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-sex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Sex differences</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Simulation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A01-troubleshooting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Troubleshooting <strong>secr</strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A02-speed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Faster is better</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A03-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Spatial data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A04-polygondetectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Area and transect search</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A05-mark-resight.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Mark-resight models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A06-noneuclidean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Non-Euclidean distances</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A07-telemetry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Telemetry</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A08-parameterizations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Parameterizations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A09-densityappendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Density revisited</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A10-trend.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Trend revisited</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A11-expected-counts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Expected counts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A12-datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Datasets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A99-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#multi-session-likelihood" id="toc-multi-session-likelihood" class="nav-link active" data-scroll-target="#multi-session-likelihood"><span class="header-section-number">5.1</span> Multi-session likelihood</a></li>
  <li><a href="#groups" id="toc-groups" class="nav-link" data-scroll-target="#groups"><span class="header-section-number">5.2</span> Groups</a></li>
  <li><a href="#esa" id="toc-esa" class="nav-link" data-scroll-target="#esa"><span class="header-section-number">5.3</span> Effective sampling area</a></li>
  <li><a href="#conditional" id="toc-conditional" class="nav-link" data-scroll-target="#conditional"><span class="header-section-number">5.4</span> Conditional estimation</a></li>
  <li><a href="#relativedensity1" id="toc-relativedensity1" class="nav-link" data-scroll-target="#relativedensity1"><span class="header-section-number">5.5</span> Relative density</a></li>
  <li><a href="#adjustment-for-spatially-selective-prior-marking" id="toc-adjustment-for-spatially-selective-prior-marking" class="nav-link" data-scroll-target="#adjustment-for-spatially-selective-prior-marking"><span class="header-section-number">5.6</span> Adjustment for spatially selective prior marking</a></li>
  <li><a href="#population-size-n" id="toc-population-size-n" class="nav-link" data-scroll-target="#population-size-n"><span class="header-section-number">5.7</span> Population size <span class="math inline">N</span></a></li>
  <li><a href="#finite-mixtures" id="toc-finite-mixtures" class="nav-link" data-scroll-target="#finite-mixtures"><span class="header-section-number">5.8</span> Finite mixture models</a></li>
  <li><a href="#hybrid-mixtures" id="toc-hybrid-mixtures" class="nav-link" data-scroll-target="#hybrid-mixtures"><span class="header-section-number">5.9</span> Hybrid finite mixture models</a></li>
  <li><a href="#parameterizations" id="toc-parameterizations" class="nav-link" data-scroll-target="#parameterizations"><span class="header-section-number">5.10</span> Alternative parameterizations</a></li>
  <li><a href="#model-based-location-of-ac" id="toc-model-based-location-of-ac" class="nav-link" data-scroll-target="#model-based-location-of-ac"><span class="header-section-number">5.11</span> Model-based location of AC</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-theory.html">Theory</a></li><li class="breadcrumb-item"><a href="./05-theory-special-topics.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Special topics</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-specialtopics" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Special topics</span></span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<p>The utility of SECR is enhanced by several extensions to the basic theory in the preceding chapters.</p>
<p>The most important of these are the linear submodels for <a href="./10-detection-model.html#linear-submodels">detection</a> and <a href="./11-density-model.html#sec-density">density</a> that we describe in their respective chapters. Others we list here.</p>
<section id="multi-session-likelihood" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="multi-session-likelihood"><span class="header-section-number">5.1</span> Multi-session likelihood</h2>
<p></p>
<p>The data may comprise multiple independent datasets to be analysed together. We call these ‘sessions’, following the terminology of <strong>secr</strong>. They may be synchronous spatial samples from non-overlapping populations or samples of the same population widely separated in time. If there are <span class="math inline">J</span> such datasets we can denote them <span class="math inline">\Omega_j, j = 1,...,J</span>. The likelihood to be maximized is then <span class="math inline">\prod_j L(\phi, \theta | \Omega_j)</span>. While the parameter vector <span class="math inline">(\phi, \theta)</span> is common to all sessions, the mechanism of <a href="10-detection-model.html#linear-submodels">linear submodels</a> allows ‘real’ parameter values to be specific to a session, common to multiple sessions, or modelled as a function of session-level covariates.</p>
<p>Failure of the independence assumption in a multi-session analysis results in underestimation of the sampling variance.</p>
</section>
<section id="groups" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="groups"><span class="header-section-number">5.2</span> Groups</h2>
<p></p>
<p>Users of MARK <span class="citation" data-cites="cw">(<a href="A99-references.html#ref-cw" role="doc-biblioref">Cooch &amp; White, 2023</a>)</span> will be familiar with the stratification of a population into ‘groups’, each with potentially different values for parameters such as survival probability. Grouping requires that each animal is assigned to a group on first detection, and that the assignment is permanent. Then density and any detection parameter may be modelled as a function of the grouping factor. Group models are available in <strong>secr</strong> only when maximizing the full likelihood. When maximizing the <a href="#conditional">conditional likelihood</a> the model may specify an individual factor covariate directly, with the same effect as grouping.</p>
<p>The multinomial coefficient in <strong>secr</strong> is stratified by group.</p>
</section>
<section id="esa" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="esa"><span class="header-section-number">5.3</span> Effective sampling area</h2>
<p></p>
<p>The effective sampling area is defined <span class="citation" data-cites="be08">(<a href="A99-references.html#ref-be08" role="doc-biblioref">Borchers &amp; Efford, 2008</a>)</span> as <span id="eq-esa"><span class="math display">
a(\theta) \equiv \int_{R^2} p_\cdot(\mathbf x; \theta) \, d\mathbf x.
\tag{5.1}</span></span></p>
<p>This is a scalar <em>effective</em> area for which <span class="math inline">\hat D = n / a(\hat \theta)</span> is an unbiased estimate of density. It does not correspond to a geographic region or delimited polygon on the ground. It bears <em>no</em> relation to the traditional ‘effective trapping area’ <span class="math inline">A_W</span> <span class="citation" data-cites="obwa78">(e.g., <a href="A99-references.html#ref-obwa78" role="doc-biblioref">Otis et al., 1978</a>)</span> for which <span class="math inline">\hat D = \hat N / A_W</span>, given a non-spatial population estimate <span class="math inline">\hat N</span> and boundary strip width <span class="math inline">W</span>. Variation in <span class="math inline">a(\theta)</span> depends not only on obviously spatial quantities such as the extent of the detector array and the spatial scale of detection <span class="math inline">\sigma</span>, but also on non-spatial quantities such as sampling effort (e.g., the number of days of trapping) and the intercept of the distance-dependent detection function (<span class="math inline">g_0, \lambda_0</span>).</p>
<p><span class="citation" data-cites="grw09">Gardner et al. (<a href="A99-references.html#ref-grw09" role="doc-biblioref">2009</a>)</span> and <span class="citation" data-cites="rnug09">Royle et al. (<a href="A99-references.html#ref-rnug09" role="doc-biblioref">2009</a>)</span> defined an ‘effective trapping area’ or ‘effective sample area’ <span class="math inline">A_e</span> somewhat differently, omitting the intercept of the detection function. To our knowledge their definition has not found further use. A version closer to ours appears in <span class="citation" data-cites="rcsg14">Royle et al. (<a href="A99-references.html#ref-rcsg14" role="doc-biblioref">2014, Section 5.12</a>)</span>.</p>
<p><span class="citation" data-cites="em14">Efford &amp; Mowat (<a href="A99-references.html#ref-em14" role="doc-biblioref">2014</a>)</span> defined a ‘single-detector sampling area’ <span class="math inline">a_0(\theta) = 2\pi \lambda_0 \sigma^2</span> that is equal to <a href="#eq-esa" class="quarto-xref">Eq.&nbsp;<span>5.1</span></a> for an isolated detector with <a href="10-detection-model.html#sec-detectfn">detection functions</a> HHN or HEX. For <span class="math inline">K</span> isolated detectors <span class="math inline">a(\theta) = Ka_0(\theta)</span>, but overlap of the ‘catchment areas’ of adjacent detectors leads to <span class="math inline">a(\theta) &lt; Ka_0(\theta)</span>.</p>
<!-- CHECK Royal and Dorazio 2008 effective sampling area cited as excellent  'approaches for estimating effective sample area...' by Hooten et al. 2024 p4. -->
</section>
<section id="conditional" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="conditional"><span class="header-section-number">5.4</span> Conditional estimation</h2>
<p></p>
<p>The detection parameters (<span class="math inline">\theta</span>) may be estimated by maximizing the likelihood conditional on <span class="math inline">n</span> (<a href="03-theory.html#eq-CL" class="quarto-xref">Eq.&nbsp;<span>3.3</span></a>). When density is constant this reduces to<br>
<span class="math display">
L_n (\theta| \Omega) \propto \prod_{i=1}^n \frac{\int_{R^2} \mathrm{Pr}(\omega_i | \mathbf x; \theta) \; d\mathbf x}{a(\theta)}.
</span> Conditioning on <span class="math inline">n</span> allows individual covariates <span class="math inline">\mathbf{z}_i</span> to be included in the detection model, so that the parameter vector takes a potentially unique value <span class="math inline">\theta_i = f(\mathbf{z}_i)</span> for each individual. The effective sampling area then varies among individuals as a function of their covariates. A corresponding Horvitz-Thompson-like derived estimate of density is <span class="math inline">\hat D_{HT} = n / \sum_{i=1}^n a(\hat \theta_i)</span> <span class="citation" data-cites="be08">(<a href="A99-references.html#ref-be08" role="doc-biblioref">Borchers &amp; Efford, 2008</a>)</span>.</p>
<p>When the conditional likelihood is maximized, the inverse Hessian provides variances for <span class="math inline">\theta</span>. The variance of the derived estimate of density depends also on the distribution of <span class="math inline">n</span>. Following <span class="citation" data-cites="h89">Huggins (<a href="A99-references.html#ref-h89" role="doc-biblioref">1989</a>)</span>, <span id="eq-varHT"><span class="math display">
\mathrm{var}(\hat D_{HT}) = s^2 + \hat {\mathbf G}^T_\theta \hat {\mathbf I} \hat {\mathbf G}_\theta
\tag{5.2}</span></span> where <span class="math inline">s^2</span> is the variance of <span class="math inline">\hat D</span> when <span class="math inline">\theta</span> is known, <span class="math inline">\hat {\mathbf I}</span> is the estimated information matrix (inverse Hessian), and <span class="math inline">\hat {\mathbf G}</span> is a vector containing the gradients of <span class="math inline">\hat D</span> with respect to the elements of <span class="math inline">\theta</span>, evaluated at the maximum likelihood estimates. Numerical evaluation of the second term is straightforward.</p>
<p>When the distribution of AC is inhomogeneous Poisson and detections are independent we expect <span class="math inline">n</span> to have a Poisson distribution. If <span class="math inline">n</span> is Poisson then <span class="math inline">s^2 = \sum_{i=1}^n a(\hat \theta_i)^{-2}</span>. This simplifies to <span class="math inline">n/a(\hat \theta)^2</span> in the absence of individual covariates.</p>
<p>When <span class="math inline">N(A)</span> is fixed, <span class="math inline">n</span> is binomial and <span class="math inline">s^2 = \sum_{i=1}^n [1 - a(\hat \theta_i)/|A|] / a(\hat \theta_i)^2</span>. <!-- or $s^2 = n [1 - a(\hat \theta)/|A|] / a(\hat \theta)^2$. --></p>
<p>The variance from <a href="#eq-varHT" class="quarto-xref">Eq.&nbsp;<span>5.2</span></a> is on the natural scale, and the Wald confidence interval computed on this scale is symmetrical. Intervals that are symmetric on the log scale and asymmetric on the natural scale have better coverage properties. These are obtained as <span class="math inline">(\hat D_{HT}/C, \hat D_{HT}C)</span> where <span class="math inline">C = \exp \{ z_{\alpha/2} \sqrt{\log[1 + \frac{\mathrm{var}(\hat D_{HT})}{\hat D_{HT}^2}]} \}</span> <span class="citation" data-cites="Burnham1987 Chao1989">(<a href="A99-references.html#ref-Burnham1987" role="doc-biblioref">Burnham et al., 1987</a>; <a href="A99-references.html#ref-Chao1989" role="doc-biblioref">Chao, 1989</a>)</span>.</p>
</section>
<section id="relativedensity1" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="relativedensity1"><span class="header-section-number">5.5</span> Relative density</h2>
<p></p>
<p>Conditioning on <span class="math inline">n</span> <em>without</em> requiring uniform density as in the previous section leads to another result that is useful. We can estimate relative density, the distribution of AC in relation to habitat covariates, rather than absolute density. Conditioning allows individual covariates of detection <span class="math inline">\mathbf z_i</span> as before, and fitting is faster than for absolute density <span class="citation" data-cites="Efford2025">(<a href="A99-references.html#ref-Efford2025" role="doc-biblioref">Efford, 2025</a>)</span>.</p>
<p>We define relative density by <span class="math inline">D^\prime(\mathbf x | \phi^-) \equiv k^{-1} D(\mathbf x | \phi)</span> where <span class="math inline">\phi^-</span> is a reduced vector of coefficients for the density submodel discussed <a href="./11-density-model.html#sec-density">later</a> and <span class="math inline">k</span> is a constant of proportionality. Then we can discard the first factor in <a href="03-theory.html#eq-L" class="quarto-xref">Eq.&nbsp;<span>3.1</span></a> and maximize a likelihood based on the second factor alone <span id="eq-rd"><span class="math display">
L_r(\phi^-, \theta | \Omega, n) \propto  \prod_{i=1}^n \frac{\int \mathrm{Pr}(\omega_i | \theta, \mathbf x) \, D^\prime(\mathbf x | \phi^-) \, p_\cdot(\mathbf x | \theta, \mathbf z_i) \; d\mathbf x}{\int  D^\prime(\mathbf x | \phi^-) \, p_\cdot(\mathbf x | \theta, \mathbf z_i) \; d\mathbf x}.
\tag{5.3}</span></span> For a log link the new parameter vector <span class="math inline">\phi^-</span> corresponds to the original <span class="math inline">\phi</span> with one coefficient, the intercept, fixed at zero. For an identity link the intercept is fixed at 1 and other coefficients are scaled. A derived estimate of the constant of proportionality is <span class="math display">
\hat k = \sum_{i=1}^n 1 / \int D^\prime(\mathbf x|\hat \phi^-) p_\cdot(\mathbf x| \hat \theta, \mathbf z_i)\, d \mathbf x.
</span> A derived estimate of the absolute density at point <span class="math inline">\mathbf x</span> is <span class="math display">
\hat D(\mathbf x | n, \hat \phi^-, \hat \theta) = \sum_{i=1}^n \frac{D^\prime(\mathbf x| \hat \phi^-)}{\int D^\prime(\mathbf x| \hat \phi^-) p_\cdot(\mathbf x| \hat \theta, \mathbf z_i)\, d \mathbf x} .
</span></p>
<p>This approach makes the same sampling assumptions as the full model, including that individuals enter the sample by a spatial detection process whose parameter vector <span class="math inline">\theta</span> we estimate from the data. For poisson-distributed AC, parameter estimates from maximizing <a href="#eq-rd" class="quarto-xref">Eq.&nbsp;<span>5.3</span></a> are identical to those of the full likelihood except for the missing density intercept.</p>
</section>
<section id="adjustment-for-spatially-selective-prior-marking" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="adjustment-for-spatially-selective-prior-marking"><span class="header-section-number">5.6</span> Adjustment for spatially selective prior marking</h2>
<p></p>
<p>In some scenarios, the <em>only</em> individuals at risk of detection are those that were marked in an earlier phase of the study. This is the case for the automated detection of animals with implanted acoustic telemetry tags or passive integrated transponders (PIT) <span class="citation" data-cites="Whoriskey2019">(e.g., <a href="A99-references.html#ref-Whoriskey2019" role="doc-biblioref">Whoriskey et al., 2019</a>)</span>. The data resemble mark–resight data (<a href="A05-mark-resight.html" class="quarto-xref"><span>Appendix E</span></a>) except that they do not include counts of unmarked animals. Estimates of <span class="math inline">\phi^-</span> using <a href="#eq-rd" class="quarto-xref">Eq.&nbsp;<span>5.3</span></a> then describe only the distribution of the individuals marked previously. Even if we can assume that AC are stationary between the two phases, <span class="math inline">\phi^-</span> is biased as a model for population distribution as it incorporates the spatial selectivity of marking.</p>
<p>Lack of information on the marking phase also afflicts mark-resight analyses <span class="citation" data-cites="eh18">(e.g., <a href="A99-references.html#ref-eh18" role="doc-biblioref">Efford &amp; Hunter, 2018</a>)</span>. The possible ‘solutions’ are all ad hoc. We can assume that the probability of becoming marked was independent of location, or we can scale <span class="math inline">p_\cdot(\mathbf x; \phi^-)</span> by an externally computed variable <span class="math inline">q(\mathbf x)</span> that is proportional to the spatial probability of marking. Essentially, <span class="math inline">q(\mathbf x)</span> is an offset in the model for relative density.</p>
<p>An example is shown <a href="11-density-model.html#relativedensity2">later</a>. A model with flat (constant) probability of prior marking is inevitably a poor fit because in reality tagged individuals are concentrated near the detectors.</p>
</section>
<section id="population-size-n" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="population-size-n"><span class="header-section-number">5.7</span> Population size <span class="math inline">N</span></h2>
<p></p>
<p>Population size is the number of individual AC in a particular region; we denote this <span class="math inline">N(A)</span> for region <span class="math inline">A</span>. For a flat density surface <span class="math inline">\mathrm{E}[N(A)] = D.|A|</span> where <span class="math inline">|A|</span> is the area of <span class="math inline">A</span>.</p>
<p><span class="math inline">D</span> and <span class="math inline">N(A)</span> are interchangeable for specified <span class="math inline">A</span>. In most applications of SECR there is no naturally defined region <span class="math inline">A</span>, and therefore <span class="math inline">\hat N(A)</span> depends on the arbitrary choice of <span class="math inline">A</span>. This weakness is not shared by <span class="math inline">\hat D</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Abundance
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Population size is sometimes termed ‘abundance’. We avoid this usage because ‘abundance’ has also been used as an umbrella term for density and population size, and its overtones are vague and biblical rather than scientific.</p>
</div>
</div>
</div>
<p>The population size of any region <span class="math inline">B</span> may be predicted <em>post hoc</em> from a fitted density model using <span class="math display">
\hat N(B) = \int_B \hat D(\mathbf x) \, d\mathbf x.
</span> The prediction variance of <span class="math inline">\hat N(B)</span> follows from Poisson assumptions regarding <span class="math inline">D(\mathbf x)</span> <span class="citation" data-cites="ef13">(<a href="A99-references.html#ref-ef13" role="doc-biblioref">Efford &amp; Fewster, 2013</a>)</span>.</p>
</section>
<section id="finite-mixtures" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="finite-mixtures"><span class="header-section-number">5.8</span> Finite mixture models</h2>
<p></p>
<p>Finite mixture models for individual heterogeneity of capture probability were formalised for non-spatial capture–recapture by <span class="citation" data-cites="p2000">Pledger (<a href="A99-references.html#ref-p2000" role="doc-biblioref">2000</a>)</span> and remain widely used <span class="citation" data-cites="cw">(e.g., <a href="A99-references.html#ref-cw" role="doc-biblioref">Cooch &amp; White, 2023</a>)</span>. These are essentially random-effect models in which the distribution of capture probability comprises two or more latent classes, each with a capture probability and probability of membership.</p>
<p><span class="citation" data-cites="be08">Borchers &amp; Efford (<a href="A99-references.html#ref-be08" role="doc-biblioref">2008, p. 381</a>)</span> gave the likelihood for a Poisson SECR model with <span class="math inline">U</span> latent classes in proportions <span class="math inline">\psi</span> = (<span class="math inline">\psi_1</span>, …, <span class="math inline">\psi_U</span>). In all examples we have tried <span class="math inline">U</span> is 2 or 3. For each class <span class="math inline">u</span> there is an associated vector of detection parameters <span class="math inline">\theta_u</span> (collectively <span class="math inline">\theta</span>). Omitting the constant multinomial term, <span class="math display">
\mathrm{Pr}(\Omega | n, \phi,\theta, \psi) \propto \prod_{i=1}^n \sum_{u=1}^U\int\frac{\mathrm{Pr}\{\omega_i | \mathbf x; \theta_u\}}{p_\cdot(\mathbf x; \theta_u)}
f(\mathbf x, u | \omega_i&gt;0) \,d\mathbf x
</span> where <span class="math display">
f(\mathbf x, u | \omega_i &gt; 0) = \frac{D(\mathbf x; \phi) p_\cdot(\mathbf x; \theta_u) \psi_u}{\sum_{u=1}^U \int D(\mathbf x; \phi) p_\cdot(\mathbf x; \theta_u) \psi_u \; d\mathbf x}.
</span></p>
<p>The expected number of detected animals <span class="math inline">n</span>, replacing <a href="03-theory.html#eq-n" class="quarto-xref">Eq.&nbsp;<span>3.2</span></a>, is a weighted sum over latent classes: <span id="eq-lambdau"><span class="math display">
\Lambda(\phi, \theta,\psi) = \sum_{u=1}^U \psi_u \int D(\mathbf x; \phi) p_\cdot(\mathbf x;\theta_u) \; d\mathbf x.
\tag{5.4}</span></span> Integration is over points in potential habitat, as usual.</p>
<p><!-- A two-class finite mixture for a parameter $\theta$ is represented by three further parameters: the values $\theta_1$ and $\theta_2$ for the two classes and  $\pi_1$ for the probability of membership in class 1 ($\pi_2 = 1-\pi_1$ for the alternate class). The mean is $\bar \theta = \sum_i \pi_i \theta_i$. The CV is $\mathrm{CV}(\theta) = \sqrt{\sum_i \pi_i (\theta_i - \bar \theta)^2} / \bar \theta$. --></p>
</section>
<section id="hybrid-mixtures" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="hybrid-mixtures"><span class="header-section-number">5.9</span> Hybrid finite mixture models</h2>
<p></p>
<p>We can modify the finite mixture likelihood for data in which the class membership of some or all individuals is known. Indicate the class membership of the <span class="math inline">i</span>-th individual by a variable <span class="math inline">u_i</span> that may take values 0, 1, …, <span class="math inline">U</span>, where <span class="math inline">u_i = 0</span> indicates an individual of unknown class, and the class frequencies are <span class="math inline">n_0</span>, <span class="math inline">n_1</span>, …, <span class="math inline">n_U</span> (not to be confused with <span class="math inline">n_1</span>,…,<span class="math inline">n_C</span> in <a href="03-theory.html#eq-CL" class="quarto-xref">Eq.&nbsp;<span>3.3</span></a>). We assume here that detection histories are sorted by class membership, starting with the unknowns.</p>
<p>The expression for <span class="math inline">\lambda</span> in <a href="#eq-lambdau" class="quarto-xref">Eq.&nbsp;<span>5.4</span></a> is unchanged, but we must split <span class="math inline">\mathrm{Pr}(\Omega | n, \phi, \theta, \psi)</span> and include a multinomial term for the observed distribution over classes:</p>
<p><span id="eq-hybrid"><span class="math display">
\begin{split}
\mathrm{Pr}(\Omega | n, \phi,\theta, \psi) \propto \; &amp;\prod_{i=1}^{n_0}\sum_{u=1}^U\int\frac{\mathrm{Pr}\{\omega_i | \mathbf x; \theta_u\}}{p_\cdot(\mathbf x ; \theta_u)}
f(\mathbf x ,u|\omega_i&gt;0) \; d\mathbf x  \\
&amp;\times
\prod_{i={n_0+1}}^n  \int \frac{\mathrm{Pr}\{\omega_i | \mathbf x; \theta_{u_i}\}}{p_\cdot(\mathbf x ; \theta_{u_i})}
f'(\mathbf x  | \omega_i&gt;0; u_i) \; d\mathbf x  \\
&amp;\times {n - n_0 \choose n_1, ...,n_U}
\prod_{u=1}^U \left[  \frac{\lambda_u}{\lambda} \right] ^{n_u},
\end{split}
\tag{5.5}</span></span></p>
<p>where <span class="math inline">\lambda_u = \psi_u \int D(\mathbf x ) p_\cdot(\mathbf x ; \theta_u) \; d\mathbf x</span>, and the multinomial coefficient <span class="math inline">{n - n_0 \choose n_1, ...,n_U}</span> is a constant that can be omitted. Rather than representing the joint probability density of <span class="math inline">\mathbf x</span> and <span class="math inline">u_i</span> as in <span class="math inline">f(\cdot)</span> previously, <span class="math inline">f'(\cdot)</span> is the probability density of <span class="math inline">\mathbf x</span> for given <span class="math inline">u_i</span>: <span class="math display">
  f'(\mathbf x  | \omega_i &gt; 0; u_i) = \frac{D(\mathbf x )p_\cdot(\mathbf x ; \theta_{u_i})}{\int D(\mathbf x )p_\cdot(\mathbf x ; \theta_{u_i}) d\mathbf x }.
</span></p>
<p>The likelihood conditions on the number of known-class animals detected (<span class="math inline">n-n_0</span>), rather than modelling class identification as a random process. It assumes that the probability that class will be recorded does not depend on class, and that such recording when it happens is without error.</p>
<p>For homogeneous density the likelihood simplifies to <span class="math display">
\begin{split}
\mathrm{Pr}(\Omega | n, \phi,\theta, \psi) \propto &amp;\prod_{i=1}^{n_0}\sum_{u=1}^U\int\frac{\mathrm{Pr}\{\omega_i | \mathbf x; \theta_u\} \psi_u} {\sum_u a(\theta_u) \psi_u } \; d\mathbf x  
\\
&amp;\times
\prod_{i={n_0+1}}^n  \int \frac{\mathrm{Pr}\{\omega_i | \mathbf x; \theta_{u_i}\}}{a(\theta_{u_i})} \;
d\mathbf x  
\prod_{u=1}^U {  \left[ \frac{a(\theta_u)\psi_u} {\sum_u a(\theta_u) \psi_u } \right] ^{n_u}},
\end{split}
</span></p>
<p>where <span class="math inline">a(\theta_u) = \int p_\cdot(\mathbf x ; \theta_{u}) \; d\mathbf x</span>.</p>
</section>
<section id="parameterizations" class="level2" data-number="5.10">
<h2 data-number="5.10" class="anchored" data-anchor-id="parameterizations"><span class="header-section-number">5.10</span> Alternative parameterizations</h2>
<p></p>
<p>The ‘real’ parameters in SECR are typically assumed to be independent (orthogonal). However, some parameter pairs co-vary in predictable ways owing to constraints on animal behaviour. Here it is more straightforward to work with the hazard detection functions. The intercept of the detection function <span class="math inline">\lambda_0</span> declines with increasing <span class="math inline">\sigma</span>, all else being equal <span class="citation" data-cites="em14">(<a href="A99-references.html#ref-em14" role="doc-biblioref">Efford &amp; Mowat, 2014</a>)</span>. This is inevitable if detection is strictly proportional to time spent near a point, given a bivariate home range utilisation model (pdf for activity). Also, home-range size and the SECR parameter <span class="math inline">\sigma</span> decline with population density <span class="citation" data-cites="edjq16">(<a href="A99-references.html#ref-edjq16" role="doc-biblioref">Efford et al., 2016</a>)</span>. Allowing for covariation may improve biological insight and lead to more parsimonious models.</p>
<p>Covariation may be ‘hard-wired’ into SECR models by reparameterization. In each case a new ‘surrogate’ parameter is proportional to a combination of the co-varying parameters. One of the co-varying parameters is seen as driving variation, while the other is inferred from the surrogate and the driver. Deviations from the expected covariation are implied when the surrogate is found to vary (i.e.&nbsp;a model with varying surrogate is superior to a model with constant surrogate).</p>
<p>For concreteness, consider a difference in home range size over the seasons, causing variation in <span class="math inline">\sigma</span>. A reasonable null hypothesis is that there will be reciprocal seasonal variation in <span class="math inline">\lambda_0</span> such that <span class="math inline">a_0 = 2 \pi \lambda_0 \sigma^2</span> is constant. Here variation in <span class="math inline">\sigma</span> is the driver, <span class="math inline">a_0</span> is the surrogate, and <span class="math inline">\lambda_0</span> is derived.</p>
<!-- ### $a = \int_{R^2} p_\cdot(\mathbf x; \theta) d\mathbf x$ [@em14] -->
<!-- The effective sampling area $a(\theta)$ meaningfully combines the detection parameters. However, inverting the integration is computationally expensive and will usually be avoided. -->
<div id="tbl-parameterizations" class="sm quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-parameterizations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.1: Parameterizations implementing three covariation models. The third option combines the first two. In <strong>secr</strong>, <span class="math inline">a_0</span> is called ‘a0’ and <span class="math inline">k</span> is called ‘sigmak’.
</figcaption>
<div aria-describedby="tbl-parameterizations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-sm small table">
<colgroup>
<col style="width: 15%">
<col style="width: 10%">
<col style="width: 15%">
<col style="width: 23%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th>Parameters</th>
<th>Driver</th>
<th>Surrogate</th>
<th>Derived</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">(D, a_0, \sigma)</span></td>
<td><span class="math inline">\sigma</span></td>
<td><span class="math inline">a_0</span></td>
<td><span class="math inline">\lambda_0 = a_0 / (2 \pi \sigma^2)</span></td>
<td>Reciprocal <span class="math inline">\sigma^2, \lambda_0</span></td>
</tr>
<tr class="even">
<td><span class="math inline">(D, \lambda_0, k)</span></td>
<td><span class="math inline">D</span></td>
<td><span class="math inline">k</span></td>
<td><span class="math inline">\sigma = k/\sqrt D</span></td>
<td>Density-dependent <span class="math inline">\sigma</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">(D, a_0, k)</span></td>
<td><span class="math inline">D</span></td>
<td><span class="math inline">k, a_0</span></td>
<td><span class="math inline">\sigma = k/\sqrt D</span></td>
<td>both</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td><span class="math inline">\lambda_0 = a_0 / (2 \pi \sigma^2)</span></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>See <a href="A08-parameterizations.html" class="quarto-xref"><span>Appendix H</span></a> for further detail on alternative parameterizations and their implementation in <strong>secr</strong>.</p>
</section>
<section id="model-based-location-of-ac" class="level2" data-number="5.11">
<h2 data-number="5.11" class="anchored" data-anchor-id="model-based-location-of-ac"><span class="header-section-number">5.11</span> Model-based location of AC</h2>
<p></p>
<p>Assume we have fitted a spatial model by integrating over the unknown locations of AC for a given SECR dataset <span class="math inline">\Omega = {\omega_1, \omega_2, ..., \omega_n}</span>. We may retrospectively infer the probability density of the AC corresponding to each detection history, using the model and the estimated parameters: <span id="eq-fxi"><span class="math display">
f(\mathbf x | \omega_i; \hat \phi, \hat \theta) = \frac{ \mathrm{Pr} (\omega_i | \mathbf x; \hat \theta) D(\mathbf x ; \hat \phi)}
{\int_{R^2} \mathrm{Pr}(\omega_i | \mathbf x; \hat \theta) D(\mathbf x ; \hat \phi) \, d \mathbf x}.
\tag{5.6}</span></span> This is equivalent to the posterior distribution of each latent AC in Bayesian applications. See <code>fxi</code> and related functions in <strong>secr</strong>. For known <span class="math inline">\theta</span> and known <span class="math inline">\phi</span> (unless <span class="math inline">D(\mathbf x; \phi)</span> uniform) the modal location of the AC for animal <span class="math inline">i</span> may be estimated by maximizing <span class="math inline">\mathrm{Pr} (\omega_i | \mathbf x; \theta)D(\mathbf x; \phi)</span> with respect to <span class="math inline">\mathbf x</span>. The distribution often has more than one mode for animals at the edge of a detector array or searched area. It should not be confused with the home range utilisation pdf.</p>
<p>A later <a href="./11-density-model.html#not-a-density-surface">section</a> discusses the use and interpretation of <span class="math inline">f(\mathbf x | \omega_i; \hat \phi, \hat \theta)</span> <span class="citation" data-cites="Durbach2024">(see also <a href="A99-references.html#ref-Durbach2024" role="doc-biblioref">Durbach et al., 2024</a>)</span>.</p>
<!-- ## Telemetry {#telemetrylikelihood} -->
<!-- [to be added] -->


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-be08" class="csl-entry" role="listitem">
Borchers, D. L., &amp; Efford, M. G. (2008). Spatially explicit maximum likelihood methods for capture-recapture studies. <em>Biometrics</em>, <em>64</em>, 377–385.
</div>
<div id="ref-Burnham1987" class="csl-entry" role="listitem">
Burnham, K. P., Anderson, D. R., White, G. C., Brownie, C., &amp; Pollock, K. H. (1987). <em>Design and analysis methods for fish survival experiments based on release-recapture</em>. American Fisheries Society.
</div>
<div id="ref-Chao1989" class="csl-entry" role="listitem">
Chao, A. (1989). Estimating population size for sparse data in capture-recapture experiments. <em>Biometrics</em>, <em>45</em>(2), 427. <a href="https://doi.org/10.2307/2531487">https://doi.org/10.2307/2531487</a>
</div>
<div id="ref-cw" class="csl-entry" role="listitem">
Cooch, E., &amp; White, G. (Eds.). (2023). <em>Program MARK: A gentle introduction.</em> (23rd ed.). <a href="http://www.phidot.org/software/mark/docs/book/">http://www.phidot.org/software/mark/docs/book/</a>
</div>
<div id="ref-Durbach2024" class="csl-entry" role="listitem">
Durbach, I., Chopara, R., Borchers, D. L., Phillip, R., Sharma, K., &amp; Stevenson, B. C. (2024). That’s not the mona lisa! How to interpret spatial capture-recapture density surface estimates. <em>Biometrics</em>, <em>80</em>(1). <a href="https://doi.org/10.1093/biomtc/ujad020">https://doi.org/10.1093/biomtc/ujad020</a>
</div>
<div id="ref-Efford2025" class="csl-entry" role="listitem">
Efford, M. G. (2025). Spatially explicit capture–recapture models for relative density. <em>BioRxiv</em>. <a href="https://doi.org/10.1101/2025.01.22.634401">https://doi.org/10.1101/2025.01.22.634401</a>
</div>
<div id="ref-edjq16" class="csl-entry" role="listitem">
Efford, M. G., Dawson, D. K., Jhala, Y. V., &amp; Qureshi, Q. (2016). Density-dependent home-range size revealed by spatially explicit capture-recapture. <em>Ecography</em>, <em>39</em>, 676–688.
</div>
<div id="ref-ef13" class="csl-entry" role="listitem">
Efford, M. G., &amp; Fewster, R. M. (2013). Estimating population size by spatially explicit capture-recapture. <em>Oikos</em>, <em>122</em>, 918–928.
</div>
<div id="ref-eh18" class="csl-entry" role="listitem">
Efford, M. G., &amp; Hunter, C. M. (2018). Spatial capture-mark-resight estimation of animal population density. <em>Biometrics</em>, <em>74</em>, 411–420. <a href="https://doi.org/10.1111/biom.12766">https://doi.org/10.1111/biom.12766</a>
</div>
<div id="ref-em14" class="csl-entry" role="listitem">
Efford, M. G., &amp; Mowat, G. (2014). Compensatory heterogeneity in spatially explicit capture-recapture data. <em>Ecology</em>, <em>95</em>, 1341–1348.
</div>
<div id="ref-grw09" class="csl-entry" role="listitem">
Gardner, B., Royle, J. A., &amp; Wegan, M. T. (2009). Hierarchical models for estimating density from DNA mark-recapture studies. <em>Ecology</em>, <em>90</em>, 1106–1115.
</div>
<div id="ref-h89" class="csl-entry" role="listitem">
Huggins, R. M. (1989). On the statistical analysis of capture experiments. <em>Biometrika</em>, <em>76</em>, 133–140.
</div>
<div id="ref-Kendeigh1944" class="csl-entry" role="listitem">
Kendeigh, S. C. (1944). Measurement of bird populations. <em>Ecological Monographs</em>, <em>14</em>, 67–106. <a href="https://doi.org/10.2307/1961632">https://doi.org/10.2307/1961632</a>
</div>
<div id="ref-obwa78" class="csl-entry" role="listitem">
Otis, D. L., Burnham, K. P., White, G. C., &amp; Anderson, D. R. (1978). Statistical inference from capture data on closed animal populations. <em>Wildlife Monographs</em>, <em>62</em>.
</div>
<div id="ref-p2000" class="csl-entry" role="listitem">
Pledger, S. (2000). Unified maximum likelihood estimates for closed capture-recapture models using mixtures. <em>Biometrics</em>, <em>56</em>, 434–442.
</div>
<div id="ref-rcsg14" class="csl-entry" role="listitem">
Royle, J. A., Chandler, R. B., Sollmann, R., &amp; Gardner, B. (2014). <em>Spatial capture-recapture</em>. Academic Press.
</div>
<div id="ref-rnug09" class="csl-entry" role="listitem">
Royle, J. A., Nichols, J. D., Karanth, K. U., &amp; Gopalaswamy, A. M. (2009). A hierarchical model for estimating density in camera‐trap studies. <em>Journal of Applied Ecology</em>, <em>46</em>(1), 118–127. <a href="https://doi.org/10.1111/j.1365-2664.2008.01578.x">https://doi.org/10.1111/j.1365-2664.2008.01578.x</a>
</div>
<div id="ref-Whoriskey2019" class="csl-entry" role="listitem">
Whoriskey, K., Martins, E. G., Auger‐Méthé, M., Gutowsky, L. F. G., Lennox, R. J., Cooke, S. J., Power, M., &amp; Mills Flemming, J. (2019). Current and emerging statistical techniques for aquatic telemetry data: A guide to analysing spatially discrete animal detections. <em>Methods in Ecology and Evolution</em>, <em>10</em>(7), 935–948. <a href="https://doi.org/10.1111/2041-210x.13188">https://doi.org/10.1111/2041-210x.13188</a>
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./04-theory-area-search.html" class="pagination-link" aria-label="Area search">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Area search</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06-assumptions.html" class="pagination-link" aria-label="Assumptions and robustness">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Assumptions and robustness</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>