<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Spatially Explicit Capture–Recapture - 17&nbsp; Simulation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./A01-troubleshooting.html" rel="next">
<link href="./16-sex.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script><script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">
<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./09-secr-package.html">Practice</a></li><li class="breadcrumb-item"><a href="./17-simulation.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Simulation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Spatially Explicit Capture–Recapture</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/MurrayEfford/SECRbook" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Foreword</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Basics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Concepts and terminology</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-example.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Simple example</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Theory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Likelihood-based SECR</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-theory-area-search.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Area search</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-theory-special-topics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Special topics</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Performance</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Assumptions and robustness</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-validation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Empirical validation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-studydesign.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Study design</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Practice</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-secr-package.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">R package secr</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-detection-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Detection model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-finite-mixtures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Individual heterogeneity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-density-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Density model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-habitat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Habitat mask</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-fittedmodels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Working with fitted models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-multisession.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Multiple sessions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-sex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Sex differences</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-simulation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Simulation</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A01-troubleshooting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Troubleshooting <strong>secr</strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A02-speed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Faster is better</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A03-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Spatial data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A04-polygondetectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Area and transect search</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A05-mark-resight.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Mark-resight models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A06-noneuclidean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Non-Euclidean distances</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A07-telemetry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Telemetry</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A08-parameterizations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Parameterizations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A09-densityappendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Density revisited</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A10-trend.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Trend revisited</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A11-expected-counts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Expected counts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A12-datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Datasets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A99-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
<li><a href="#simulation-step-by-step" id="toc-simulation-step-by-step" class="nav-link active" data-scroll-target="#simulation-step-by-step"><span class="header-section-number">17.1</span> Simulation step by step</a></li>
  <li><a href="#secrdesign" id="toc-secrdesign" class="nav-link" data-scroll-target="#secrdesign"><span class="header-section-number">17.2</span> Simulation in <strong>secrdesign</strong></a></li>
  <li><a href="#advanced-simulations" id="toc-advanced-simulations" class="nav-link" data-scroll-target="#advanced-simulations"><span class="header-section-number">17.3</span> Advanced simulations</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./09-secr-package.html">Practice</a></li><li class="breadcrumb-item"><a href="./17-simulation.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Simulation</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-simulation" class="quarto-section-identifier"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Simulation</span></span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header><!--    flow chart --><!--     overlap coefficient k --><!--     number of replicates small for RSE --><!--     method = "none" (compare) --><!-- Suggest base standard: --><!-- large array 12 x 12 --><!-- small array 8 x 8 --><!-- HHN --><!-- 2-sigma spacing --><!-- 4-sigma buffer --><!-- 1 occasion, binomial N=5 --><!-- lambda0 = 1 --><!-- secr-simulations --><p>Simulation has many uses in SECR; we focus particularly on</p>
<ul>
<li>determining properties of estimators under breaches of assumptions (<a href="06-assumptions.html" class="quarto-xref"><span>Chapter 6</span></a>),</li>
<li>assessing candidate study designs (<a href="08-studydesign.html" class="quarto-xref"><span>Chapter 8</span></a>), and</li>
<li>assessing goodness of fit (<a href="14-fittedmodels.html" class="quarto-xref"><span>Chapter 14</span></a>).</li>
</ul>
<p>The first two of these are not related to the analysis of a dataset and the required ‘de novo’ simulations follow essentially the same steps in <strong>secr</strong>, as detailed below. The third entails simulation from a particular model fitted to data, as considered <a href="./14-fittedmodels.html#sec-modelfit">earlier</a>. Other uses of simulation are more niche – parameter estimation <span class="citation" data-cites="Efford2023">(<a href="A99-references.html#ref-Efford2023" role="doc-biblioref">Efford, 2023</a>)</span>, testing software implementations, and the computation of parametric bootstrap confidence intervals.</p>
<p>This chapter aims to demystify simulation and make it available to a wider range of SECR users. We start by breaking a simulation down into the component steps, showing how each of these may be performed in <strong>secr</strong>. Later we introduce the package <strong>secrdesign</strong> that manages these steps for greater efficiency.</p>
<section id="simulation-step-by-step" class="level2" data-number="17.1"><h2 data-number="17.1" class="anchored" data-anchor-id="simulation-step-by-step">
<span class="header-section-number">17.1</span> Simulation step by step</h2>
<p>The essential steps for each replicate of a <em>de novo</em> SECR simulation are</p>
<ol type="1">
<li>Generate an instance of the population process, i.e.&nbsp;the distribution of activity centres AC.</li>
<li>Generate a set of ‘observed’ spatial detection histories from the AC distribution according to some study design (detector layout, sampling duration), and detection parameters (e.g., <span class="math inline">\lambda_0, \sigma</span>).</li>
<li>Fit an SECR model to estimate parameters of the population and detection processes, along with their sampling variances.</li>
</ol>
<p>It is simple enough to perform steps 1 &amp; 2 directly in R without the use of <strong>secr</strong> functions. We give an example before describing functions that cover many variations with less code.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 1. Generate population</span></span>
<span><span class="va">D</span>     <span class="op">&lt;-</span> <span class="fl">20</span>                               <span class="co"># AC per hectare</span></span>
<span><span class="va">EN</span>    <span class="op">&lt;-</span> <span class="va">D</span> <span class="op">*</span> <span class="fl">9</span>                            <span class="co"># expected number in 9 ha</span></span>
<span><span class="va">N</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">EN</span><span class="op">)</span>                     <span class="co"># realised number of AC</span></span>
<span><span class="va">popxy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">N</span><span class="op">)</span><span class="op">*</span><span class="fl">300</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># points in 300-m square</span></span>
<span></span>
<span><span class="co"># Step 2. Sample from population with central 6 x 6 detector array</span></span>
<span><span class="va">detxy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">200</span>,<span class="fl">20</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">200</span>,<span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">K</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">detxy</span><span class="op">)</span>                      <span class="co"># number of detectors</span></span>
<span><span class="va">S</span>     <span class="op">&lt;-</span> <span class="fl">5</span>                                <span class="co"># number of occasions</span></span>
<span><span class="va">g0</span>    <span class="op">&lt;-</span> <span class="fl">0.2</span>                              <span class="co"># detection parameter</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">20</span>                               <span class="co"># detection parameter</span></span>
<span><span class="va">d</span>     <span class="op">&lt;-</span> <span class="fu">secr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/secr/man/utility.html">edist</a></span><span class="op">(</span><span class="va">popxy</span>, <span class="va">detxy</span><span class="op">)</span>        <span class="co"># distance to detectors</span></span>
<span><span class="va">p</span>     <span class="op">&lt;-</span> <span class="va">g0</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">d</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">2</span><span class="op">/</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>         <span class="co"># probability detected</span></span>
<span><span class="va">detected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">*</span><span class="va">K</span><span class="op">*</span><span class="va">S</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">p</span>,<span class="va">S</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ch</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span><span class="va">detected</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">N</span>,<span class="va">K</span>,<span class="va">S</span><span class="op">)</span>, dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span>, <span class="fl">1</span><span class="op">:</span><span class="va">K</span>, <span class="fl">1</span><span class="op">:</span><span class="va">S</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ch</span>    <span class="op">&lt;-</span> <span class="va">ch</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">ch</span>,<span class="fl">1</span>,<span class="va">sum</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span>,,<span class="op">]</span>          <span class="co"># reject null histories</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For analysis in <strong>secr</strong> the simulated detection data should be recast as a ‘capthist’ object with the detector array as an attribute:</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">detxy</span><span class="op">)</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'traps'</span>, <span class="st">'data.frame'</span><span class="op">)</span></span>
<span><span class="fu">detector</span><span class="op">(</span><span class="va">detxy</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">'proximity'</span></span>
<span><span class="va">ch</span>              <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/aperm.html">aperm</a></span><span class="op">(</span><span class="va">ch</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>   <span class="co"># permute dim to N, S, K</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">ch</span><span class="op">)</span>       <span class="op">&lt;-</span> <span class="st">'capthist'</span></span>
<span><span class="fu">traps</span><span class="op">(</span><span class="va">ch</span><span class="op">)</span>       <span class="op">&lt;-</span> <span class="va">detxy</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that the data are in the right shape we can proceed to fit a model:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 3. Fit model to simulated capthist</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">secr.fit</span><span class="op">(</span><span class="va">ch</span>, buffer <span class="op">=</span> <span class="fl">100</span>, trace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       link estimate SE.estimate     lcl      ucl
D       log 13.05859     2.37265  9.1726 18.59085
g0    logit  0.17975     0.02644  0.1336  0.23748
sigma   log 23.27774     1.89206 19.8549 27.29066</code></pre>
</div>
</div>
<p>This is rather laborious and it’s easy to slip up. We next outline the <strong>secr</strong> functions <code>sim.popn</code> and <code>sim.capthist</code> that conveniently wrap Steps 1 &amp; 2, respectively, along with many extensions.</p>
<p>A further level of wrapping is provided by package <a href="#secrdesign"><strong>secrdesign</strong></a> that manages simulation scenarios, their replicated execution (Steps 1–3), and the summarisation of results.</p>
<section id="simulating-ac-distributions-with-sim.popn" class="level3" data-number="17.1.1"><h3 data-number="17.1.1" class="anchored" data-anchor-id="simulating-ac-distributions-with-sim.popn">
<span class="header-section-number">17.1.1</span> Simulating AC distributions with <code>sim.popn</code>
</h3>
<p></p>
<p>A simulated AC distribution is an object of class ‘popn’ in <strong>secr</strong>. This is usually a distribution of points within a rectangular region that is the bounding box of a ‘core’ object (most likely a ‘traps’ object) inflated by a certain ‘buffer’ distance in metres. <code>sim.popn</code> generates a ‘popn’ object, for which there is a <code>plot</code> method.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tr</span> <span class="op">&lt;-</span> <span class="fu">make.grid</span><span class="op">(</span><span class="op">)</span>  <span class="co"># a traps object, for demonstration</span></span>
<span><span class="va">pop</span> <span class="op">&lt;-</span> <span class="fu">sim.popn</span><span class="op">(</span>D <span class="op">=</span> <span class="fl">10</span>, core <span class="op">=</span> <span class="va">tr</span>, buffer <span class="op">=</span> <span class="fl">100</span>, </span>
<span>    model2D <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">tr</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-simpopn" class="quarto-figure quarto-figure-center quarto-float anchored" width="70%">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-simpopn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="17-simulation_files/figure-html/fig-simpopn-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-1" data-gallery="quarto-lightbox-gallery-1"><img src="17-simulation_files/figure-html/fig-simpopn-1.png" id="fig-simpopn" class="img-fluid figure-img" style="width:70.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-simpopn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.1
</figcaption></figure>
</div>
</div>
</div>
<p>The default 2-D distribution is random uniform - a Poisson distribution, as shown here. The expected number of activity centres E(<em>N<sub>A</sub></em>) is determined by the argument D, the density in AC per hectare. By default <em>N<sub>A</sub></em> is a Poisson random variable, but it may be fixed by setting <code>Ndist = "fixed"</code>. Published simulations often fix <em>N<sub>A</sub></em> for reasons of convenience such as avoiding realisations that may be hard to model or reducing the variance among replicates. Comparisons must therefore be made with care.</p>
<p>For <code>Ndist = "poisson"</code> the choice of buffer is not critical so long as it is large enough to include all potentially detected AC. Simulated populations with excessively large <em>N<sub>A</sub></em> take longer to sample (the next step - generating a capthist object), but the ultimate capthist is no larger and model fitting takes the same time.</p>
<p>Inhomogeneous alternatives to a uniform random distribution may be specified using the arguments ‘model2D’ and ‘details’. We elaborate on these <a href="#inhomogeneous">later</a>.</p>
</section><section id="simulating-detection-with-sim.capthist" class="level3" data-number="17.1.2"><h3 data-number="17.1.2" class="anchored" data-anchor-id="simulating-detection-with-sim.capthist">
<span class="header-section-number">17.1.2</span> Simulating detection with <code>sim.capthist</code>
</h3>
<p></p>
<p>To simulate sampling of a given population we specify the type and spatial distribution of detectors, the detection function, and the duration of sampling. Detectors are prepared in advance as an object of class ‘traps’, either input from a data file or generated by one of the functions for a specific geometry (<code>make.grid</code>, <code>trap.builder</code>, <code>make.systematic</code>, <code>make.circle</code> etc.).</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ch</span> <span class="op">&lt;-</span> <span class="fu">sim.capthist</span><span class="op">(</span>traps <span class="op">=</span> <span class="va">tr</span>, popn <span class="op">=</span> <span class="va">pop</span>, detectpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    g0 <span class="op">=</span> <span class="fl">0.1</span>, sigma <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>, noccasions <span class="op">=</span> <span class="fl">5</span>, renumber <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ch</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Object class       capthist 
Detector type      multi (5) 
Detector number    36 
Average spacing    20 m 
x-range            0 100 m 
y-range            0 100 m 

Counts by occasion 
                   1  2  3  4  5 Total
n                  4 10  5  8  7    34
u                  4  7  2  4  2    19
f                  9  7  1  2  0    19
M(t+1)             4 11 13 17 19    19
losses             0  0  0  0  0     0
detections         4 10  5  8  7    34
detectors visited  4 10  5  7  7    33
detectors used    36 36 36 36 36   180

Individual covariates
 sex   
 F: 8  
 M:11  </code></pre>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ch</span>, tracks <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.capthist(ch, tracks = TRUE): rad argument 5 exceeds 3% of detector
span 100</code></pre>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">pop</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">captured</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">pop</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">ch</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">captured</span>, pch <span class="op">=</span> <span class="fl">16</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-simcapthist" class="quarto-figure quarto-figure-center quarto-float anchored" width="70%">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-simcapthist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="17-simulation_files/figure-html/fig-simcapthist-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-2" data-gallery="quarto-lightbox-gallery-2"><img src="17-simulation_files/figure-html/fig-simcapthist-1.png" id="fig-simcapthist" class="img-fluid figure-img" style="width:70.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-simcapthist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.2
</figcaption></figure>
</div>
</div>
</div>
</section><section id="combining-data-generation-and-model-fitting" class="level3" data-number="17.1.3"><h3 data-number="17.1.3" class="anchored" data-anchor-id="combining-data-generation-and-model-fitting">
<span class="header-section-number">17.1.3</span> Combining data generation and model fitting</h3>
<p>We loop over the AC-generation, sampling, and model-fitting steps, recording the results for later.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tr</span> <span class="op">&lt;-</span> <span class="fu">make.grid</span><span class="op">(</span><span class="op">)</span>  <span class="co"># a traps object</span></span>
<span><span class="va">nrepl</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nrepl</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">pop</span> <span class="op">&lt;-</span> <span class="fu">sim.popn</span><span class="op">(</span>D <span class="op">=</span> <span class="fl">20</span>, core <span class="op">=</span> <span class="va">tr</span>, buffer <span class="op">=</span> <span class="fl">100</span>, </span>
<span>        model2D <span class="op">=</span> <span class="st">"poisson"</span><span class="op">)</span></span>
<span>    <span class="va">ch</span> <span class="op">&lt;-</span> <span class="fu">sim.capthist</span><span class="op">(</span>traps <span class="op">=</span> <span class="va">tr</span>, popn <span class="op">=</span> <span class="va">pop</span>, detectpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        g0 <span class="op">=</span> <span class="fl">0.2</span>, sigma <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>, noccasions <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span>    <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">secr.fit</span><span class="op">(</span><span class="va">ch</span>, buffer<span class="op">=</span><span class="fl">100</span>, trace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="va">out</span><span class="op">[[</span><span class="va">r</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Each output returned by the <code>predict</code> method is a dataframe from which we extract the density estimate and its standard error to form the summary:</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">trueD</span>  <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">Dhat</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">out</span>, <span class="st">'['</span>, <span class="st">'D'</span>, <span class="st">'estimate'</span><span class="op">)</span></span>
<span><span class="va">seDhat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">out</span>, <span class="st">'['</span>, <span class="st">'D'</span>, <span class="st">'SE.estimate'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span> <span class="op">(</span><span class="st">"mean  "</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Dhat</span><span class="op">)</span>, <span class="st">'\n'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span> <span class="op">(</span><span class="st">"RB    "</span>, <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Dhat</span><span class="op">)</span><span class="op">-</span><span class="va">trueD</span><span class="op">)</span> <span class="op">/</span> <span class="va">trueD</span>, <span class="st">'\n'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span> <span class="op">(</span><span class="st">"RSE   "</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">seDhat</span> <span class="op">/</span> <span class="va">Dhat</span><span class="op">)</span>, <span class="st">'\n'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span> <span class="op">(</span><span class="st">"rRMSE "</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">Dhat</span><span class="op">-</span><span class="va">trueD</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Dhat</span><span class="op">)</span>, <span class="st">'\n'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mean   20.52 
RB     0.025987 
RSE    0.15481 
rRMSE  0.14281 </code></pre>
</div>
</div>
<!-- (Duration may vary by detector) -->
<!-- ``` -->
<!-- sim.capthist (traps, popn = list(D = 5, buffer = 100, Ndist = "poisson"),  -->
<!--     detectfn = 0, detectpar = list(), noccasions = 5, nsessions = 1,  -->
<!--     renumber = TRUE, seed = NULL, etc.) -->
<!-- ``` -->
</section></section><section id="secrdesign" class="level2" data-number="17.2"><h2 data-number="17.2" class="anchored" data-anchor-id="secrdesign">
<span class="header-section-number">17.2</span> Simulation in <strong>secrdesign</strong>
</h2>
<p> </p>
<p>The R package <strong>secrdesign</strong> takes care of a lot of the coding needed to specify, execute and summarise SECR simulations. Full details are in its documentation, particularly <a href="https://www.otago.ac.nz/density/pdfs/secrdesign-vignette.pdf">secrdesign-vignette.pdf</a>.</p>
<p>The heart of <strong>secrdesign</strong> is a dataframe of one or more <em>scenarios</em>. Usually there is one row per scenario. The scenario dataframe is constructed with <code>make.scenarios</code>. Some properties of scenarios, such as expected sample sizes, may be extracted without simulation using <code>scenarioSummary</code>. This is a good first check.</p>
<p>Simulations are executed with <code>run.scenarios</code>, with or without model fitting. The resulting object is summarised either directly (with the <code>summary</code> method) or after further processing to select fields and statistics. Several arguments of <code>run.scenarios</code> comprise lookup lists from which each scenario selects according to a numeric index field. For example, ‘trapset’ is a list of detector layouts, from which each scenario selects via its ‘trapsindex’ column. Likewise ‘pop.args’, ‘det.args’, and ‘fit.args’ are lists corresponding to the ‘popindex’, ‘detindex’ and ‘fitindex’ columns of the scenario data.frame. These optionally provide fine control of <code>sim.popn</code>, <code>sim.capthist</code> and <code>secr.fit</code>, respectively. The saved output may be customized via the ‘extractfn’ argument.</p>
<p>This small demonstration repeats the simulation in the preceding code. ‘xsigma’ specifies the buffer width as a multiple of ‘sigma’.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.otago.ac.nz/density/">secrdesign</a></span><span class="op">)</span></span>
<span><span class="va">tr</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/secr/man/make.traps.html">make.grid</a></span><span class="op">(</span><span class="op">)</span>  </span>
<span><span class="va">scen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/secrdesign/man/make.scenarios.html">make.scenarios</a></span> <span class="op">(</span>D <span class="op">=</span> <span class="fl">20</span>, g0 <span class="op">=</span> <span class="fl">0.2</span>, sigma <span class="op">=</span> <span class="fl">20</span>, </span>
<span>    noccasions <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/secrdesign/man/run.scenarios.html">run.scenarios</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">scen</span>, <span class="va">tr</span>, xsigma <span class="op">=</span> <span class="fl">5</span>, fit <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span>    </span>
<span><span class="co">## Completed scenario 1</span></span>
<span><span class="co">## Completed in 0.036 minutes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can get a compact summary like this:</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/secrdesign/man/estimateSummary.html">estimateSummary</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  scenario true.D nvalid    EST  seEST       RB     seRB     RSE   RMSE   rRMSE COV
1        1     20     10 20.511 1.2833 0.025526 0.064167 0.15498 3.8837 0.19419 0.9</code></pre>
</div>
</div>
<p>The default sampling function <code>sim.capthist</code> is usually adequate, but an alternative may be specified via the argument ‘CH.function’.</p>
<p>Simulation quite often results in data that are too sparse for analysis, and other malfunctions are possible. As a user you should be on your guard for meaningless, extreme values in the estimates. The <code>validate</code> function provides a mechanism for filtering these out.</p>
</section><section id="advanced-simulations" class="level2" data-number="17.3"><h2 data-number="17.3" class="anchored" data-anchor-id="advanced-simulations">
<span class="header-section-number">17.3</span> Advanced simulations</h2>
<section id="inhomogeneous" class="level3" data-number="17.3.1"><h3 data-number="17.3.1" class="anchored" data-anchor-id="inhomogeneous">
<span class="header-section-number">17.3.1</span> Inhomogeneous populations</h3>
<p>Variations on a uniform distribution of AC are selected with the <code>sim.popn</code> argument ‘model2D’. This may be done directly, as when we first introduced <code>sim.popn</code>, or indirectly via the ‘pop.args’ argument of <code>run.scenarios</code>. While almost any process may be used to generate data, only the parameters of an inhomogeneous Poisson process may be estimated by fitting models in <strong>secr</strong>. Alternative methods are available for some other generating models <span class="citation" data-cites="Stevenson2021 Dey2023">(<a href="A99-references.html#ref-Dey2023" role="doc-biblioref">Dey et al., 2023</a>; e.g., <a href="A99-references.html#ref-Stevenson2021" role="doc-biblioref">Stevenson et al., 2021</a>)</span>.</p>
<p>We next consider three types of point process that may be used to simulate inhomogeneous distributions of activity centres in <code>sim.popn</code>.</p>
<section id="inhomogeneous-poisson-process" class="level4" data-number="17.3.1.1"><h4 data-number="17.3.1.1" class="anchored" data-anchor-id="inhomogeneous-poisson-process">
<span class="header-section-number">17.3.1.1</span> Inhomogeneous Poisson Process</h4>
<p>An inhomogeneous Poisson process (IHPP) is specified by setting ‘model2D = “IHP”’. The argument ‘core’ should be a <a href="#Habitat">habitat mask</a>. Cell-specific density (expected number of individuals per hectare) may be given either in a covariate of the mask (named in argument ‘D’) or as a vector of values in argument ‘D’. The covariate option allows you to simulate from a previously fitted Dsurface (output from <code>predictDsurface</code>). Special cases of IHPP are provided in the ‘hills’ and ‘coastal’ options for ‘model2D’.</p>
</section><section id="LGCP" class="level4" data-number="17.3.1.2"><h4 data-number="17.3.1.2" class="anchored" data-anchor-id="LGCP">
<span class="header-section-number">17.3.1.2</span> Cox Processes</h4>
<p>In a Cox process the expected density surface of the IHPP varies randomly between realisations (i.e.&nbsp;replicates). For example, <strong>secr</strong> has the function <code>randomDensity</code> that may be used in <code>sim.popn</code> to generate a new binary density mosaic at each call (see Examples on its help page).</p>
<p>A flexible model for continuous variation in density is the log-Gaussian Cox Process (LGCP) <span class="citation" data-cites="Johnson2010 drns21 Efford2024">(<a href="A99-references.html#ref-drns21" role="doc-biblioref">Dupont et al., 2021</a>; <a href="A99-references.html#ref-Efford2024" role="doc-biblioref">Efford &amp; Fletcher, 2024</a>; <a href="A99-references.html#ref-Johnson2010" role="doc-biblioref">Johnson et al., 2010</a>)</span>. The IHPP log-intensity surface of a LGCP is Gaussian (normally distributed) at each point, but adjacent points co-vary; autocorrelation declines with distance. The notation and parameterisation can be confusing. The term ‘Gaussian’ refers to the marginal intensity, not the autocorrelation function which is commonly exponential. The Gaussian variance is on the log scale, so even a variance as low as 1.0 indicates substantial heterogeneity. The exponential scale parameter naturally has the same units as the SECR detection function, although <span class="citation" data-cites="drns21">Dupont et al. (<a href="A99-references.html#ref-drns21" role="doc-biblioref">2021</a>)</span> rescaled it as 6% or 100% of the width of the study area. <strong>secr</strong> uses the function <code>rLGCP</code> from <strong>spatstat</strong> <span class="citation" data-cites="Baddeley2015">(<a href="A99-references.html#ref-Baddeley2015" role="doc-biblioref">Baddeley et al., 2015</a>)</span> which in turn depends on <strong>RandomFields</strong> <span class="citation" data-cites="Schlather2015">(<a href="A99-references.html#ref-Schlather2015" role="doc-biblioref">Schlather et al., 2015</a>)</span>.</p>
<!-- GRF parameters for inhomogeneous Poisson process i.e. LGCP -->
<!-- (i) mean density -->
<!-- (ii) marginal variance $\sigma_D^2$ -->
<!-- (iii) spatial correlation function -->
<!-- (problem that lack intuitive interpretation; R package **RandomFields** not on CRAN; idiosyncratic variations) -->
</section><section id="cluster-processes" class="level4" data-number="17.3.1.3"><h4 data-number="17.3.1.3" class="anchored" data-anchor-id="cluster-processes">
<span class="header-section-number">17.3.1.3</span> Cluster Processes</h4>
<p>The points in a 2-D cluster process are no longer independent, as in an IHPP. Each belongs to a cluster. For the Thomas process that has been applied in SECR [e.g., ebb09] there is a Poisson distribution of ‘parents’ and a bivariate-normal scatter of offspring points about each parent. Both the number of parents and the number of offspring per parent are Poisson variables, and hence some clusters may be empty. Thomas processes belong to the broader class of Neyman-Scott cluster processes. <strong>secr</strong> implements an interface to the function <code>rThomas</code> from <strong>spatstat</strong> <span class="citation" data-cites="Baddeley2015">(<a href="A99-references.html#ref-Baddeley2015" role="doc-biblioref">Baddeley et al., 2015</a>)</span> (‘model2D = “rThomas”’).</p>
</section></section><section id="summary-of-inhomogeneous-options" class="level3" data-number="17.3.2"><h3 data-number="17.3.2" class="anchored" data-anchor-id="summary-of-inhomogeneous-options">
<span class="header-section-number">17.3.2</span> Summary of inhomogeneous options</h3>
<p>Both Cox and cluster processes require additional parameters to be specified in the ‘details’ argument of <code>sim.popn</code> (<a href="#tbl-model2D" class="quarto-xref">Table&nbsp;<span>17.1</span></a>). <a href="#fig-model2D" class="quarto-xref">Fig.&nbsp;<span>17.3</span></a> provides examples.</p>
<div id="tbl-model2D" class="sm quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model2D-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;17.1: Distribution of activity centres in <code>sim.popn</code> controlled by argument ‘model2D’ with additional parameters specified in the ‘details’ argument
</figcaption><div aria-describedby="tbl-model2D-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-sm small table">
<thead><tr class="header">
<th style="text-align: left;">Type</th>
<th style="text-align: left;">model2D</th>
<th style="text-align: left;">details</th>
<th style="text-align: left;">Note</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Uniform</td>
<td style="text-align: left;">“poisson”</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">IHPP</td>
<td style="text-align: left;">“IHP”</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">cell densities pre-computed</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">“hills”</td>
<td style="text-align: left;">hills</td>
<td style="text-align: left;">sine-curve density in 2-D</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">“coastal”</td>
<td style="text-align: left;">Beta</td>
<td style="text-align: left;">extreme gradients cf <span class="citation" data-cites="fb04">Fewster &amp; Buckland (<a href="A99-references.html#ref-fb04" role="doc-biblioref">2004</a>)</span>
</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cox process</td>
<td style="text-align: left;">“rLGCP”</td>
<td style="text-align: left;">var, scale</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Cluster process</td>
<td style="text-align: left;">“rThomas”</td>
<td style="text-align: left;">mu, scale</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-model2D" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-model2D-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="17-simulation_files/figure-html/fig-model2D-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-3" data-gallery="quarto-lightbox-gallery-3"><img src="17-simulation_files/figure-html/fig-model2D-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model2D-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.3: Examples of AC distributions simulated with <code>sim.popn</code>. Yellow dots indicate location of cluster ‘parents’, some of which lie outside the frame.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="spatial-repulsion" class="level3" data-number="17.3.3"><h3 data-number="17.3.3" class="anchored" data-anchor-id="spatial-repulsion">
<span class="header-section-number">17.3.3</span> Spatial repulsion</h3>
<p>We can imagine scenarios in which AC are distributed more evenly than expected from a random uniform distribution, perhaps due to territorial behaviour. A point process model with repulsion between AC was considered by <span class="citation" data-cites="Reich2014">Reich &amp; Gardner (<a href="A99-references.html#ref-Reich2014" role="doc-biblioref">2014</a>)</span>. There is no equivalent model in <code>sim.popn</code>. However, the option ‘model2D = “even”’ goes some way towards it: space is divided into notional square grid cells of area <em>1/D</em> and one AC is located randomly within each cell (<a href="#fig-model2D" class="quarto-xref">Fig.&nbsp;<span>17.3</span></a>).</p>
</section><section id="inhomogeneous-detection" class="level3" data-number="17.3.4"><h3 data-number="17.3.4" class="anchored" data-anchor-id="inhomogeneous-detection">
<span class="header-section-number">17.3.4</span> Inhomogeneous detection</h3>
<p>Simulating spatial variation in detection parameters is a minefield: there are many subtly different approaches and <em>ad hoc</em> variations <span class="citation" data-cites="Royle2013 e14 Moqanaki2021 Dey2023 Stevenson2021 Hooten2024">(<a href="A99-references.html#ref-Dey2023" role="doc-biblioref">Dey et al., 2023</a>; <a href="A99-references.html#ref-e14" role="doc-biblioref">Efford, 2014</a>; <a href="A99-references.html#ref-Hooten2024" role="doc-biblioref">Hooten et al., 2024</a>; <a href="A99-references.html#ref-Moqanaki2021" role="doc-biblioref">Moqanaki et al., 2021</a>; <a href="A99-references.html#ref-Royle2013" role="doc-biblioref">Royle et al., 2013</a>; <a href="A99-references.html#ref-Stevenson2021" role="doc-biblioref">Stevenson et al., 2021</a>)</span>.</p>
<p>The first question is whether to focus on the location of the detector or the location of the activity centres. We label these approaches ‘detector-centric’ and ‘AC-centric’. Focusing on detectors is simpler as they comprise a few discrete locations whereas AC are at unknown locations in continuous space.</p>
<p><code>sim.capthist</code> allows values of g0 and lambda0 to be detector-specific. Values are provided as an occasion x detector matrix.</p>
<p>The authors cited at the start of this section were mainly concerned with [detector-centric] spatially auto-correlated random effects (‘SARE’, following <span class="citation" data-cites="Dey2023">Dey et al. (<a href="A99-references.html#ref-Dey2023" role="doc-biblioref">2023</a>)</span>). Random variation among detectors may be modelled on the link scale by a Gaussian random field. Simulation is simpler than the <a href="#LGCP">LGCP</a> for AC because values are required only at the <em>K</em> detectors. Deviates are obtained from a random <em>K</em>-dimensional multivariate normal distribution with distance-dependent covariance matrix <span class="citation" data-cites="Moqanaki2021">(e.g., <a href="A99-references.html#ref-Moqanaki2021" role="doc-biblioref">Moqanaki et al., 2021</a>)</span>. Simulation in <strong>secr</strong> uses custom functions, for which there are several examples on <a href="https://htmlpreview.github.io/?https://github.com/MurrayEfford/secr-simulations/blob/main/SARE/secr-simulations-SARE.html">GitHub</a> with comments on parameterisation.</p>
<p>A purely detector-centric approach does not allow for a model in which the activity of an individual at one point in its home range depends on resource availability both there and at other points. Normalisation of activity must then account for resource distribution in continuous space <span class="citation" data-cites="e14">(see <a href="A99-references.html#ref-e14" role="doc-biblioref">Efford, 2014</a> and the preceding GitHub site)</span>. <span class="citation" data-cites="Moqanaki2021">Moqanaki et al. (<a href="A99-references.html#ref-Moqanaki2021" role="doc-biblioref">2021</a>)</span> transformed to uniform (-1.96, 1.96)</p>
<p>There are more arcane options for simulating AC-centric variation in detection:</p>
<ul>
<li>covariates ‘lambda0’ and ‘sigma’ may be added to simulated populations on the basis of the x-y coordinates of the AC, and used in <code>sim.capthist</code> by setting ‘detectpar = list(individual = TRUE)’ (requires <strong>secr</strong> <span class="math inline">\ge</span> 4.6.7)</li>
<li>the ‘userdist’ argument may be used to ‘warp’ space and hence the effective sigma (cf <a href="A06-noneuclidean.html" class="quarto-xref"><span>Appendix F</span></a>)</li>
<li>discrete non-overlapping populations may be simulated and pasted together <em>post hoc</em>.</li>
</ul>
<!-- * @Royle2013, @e14 cloglog $\alpha_0, \alpha_1, \alpha2$ --><!-- * @Moqanaki2021 $\beta_0, \beta_X$ quasi-sq-exponential --><!-- * @Dey2023 $\phi$ exponential --><!-- * @Stevenson2021 $\rho$ exponential, sq-exponential --><!-- * @Hooten2024   -->

<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-1">Figure&nbsp;17.1: </span>
<span class="glightbox-desc lightbox-desc-2">Figure&nbsp;17.2: </span>
<span class="glightbox-desc lightbox-desc-3">Figure&nbsp;17.3: Examples of AC distributions simulated with <code>sim.popn</code>. Yellow dots indicate location of cluster ‘parents’, some of which lie outside the frame.</span>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-Baddeley2015" class="csl-entry" role="listitem">
Baddeley, A., Rubak, E., &amp; Turner, R. (2015). <em>Spatial point patterns</em>. Chapman; Hall/CRC. <a href="https://doi.org/10.1201/b19708">https://doi.org/10.1201/b19708</a>
</div>
<div id="ref-Dey2023" class="csl-entry" role="listitem">
Dey, S., Moqanaki, E., Milleret, C., Dupont, P., Tourani, M., &amp; Bischof, R. (2023). Modelling spatially autocorrelated detection probabilities in spatial capture-recapture using random effects. <em>Ecological Modelling</em>, <em>479</em>, 110324. <a href="https://doi.org/10.1016/j.ecolmodel.2023.110324">https://doi.org/10.1016/j.ecolmodel.2023.110324</a>
</div>
<div id="ref-drns21" class="csl-entry" role="listitem">
Dupont, G., Royle, J. A., Nawaz, M. A., &amp; Sutherland, C. (2021). Optimal sampling design for spatial capture-recapture. <em>Ecology</em>, <em>102</em>, e03262.
</div>
<div id="ref-e14" class="csl-entry" role="listitem">
Efford, M. G. (2014). Bias from heterogeneous usage of space in spatially explicit capture-recapture analyses. <em>Methods in Ecology and Evolution</em>, <em>5</em>, 599–602.
</div>
<div id="ref-Efford2023" class="csl-entry" role="listitem">
Efford, M. G. (2023). <span class="nocase">ipsecr: An R package for awkward spatial capture–recapture data</span>. <em>Methods in Ecology and Evolution</em>, <em>14</em>(5), 1182–1189. <a href="https://doi.org/10.1111/2041-210x.14088">https://doi.org/10.1111/2041-210x.14088</a>
</div>
<div id="ref-Efford2024" class="csl-entry" role="listitem">
Efford, M. G., &amp; Fletcher, D. (2024). Effect of spatial overdispersion on confidence intervals for population density estimated by spatial capture-recapture. <em>bioRxiv</em>. <a href="https://doi.org/10.1101/2024.03.12.584742">https://doi.org/10.1101/2024.03.12.584742</a>
</div>
<div id="ref-fb04" class="csl-entry" role="listitem">
Fewster, R. M., &amp; Buckland, S. T. (2004). Assessment of distance sampling estimators. In S. T. Buckland, D. R. Anderson, K. P. Burnham, J. L. Laake, D. L. Borchers, &amp; L. Thomas (Eds.), <em>Advanced distance sampling</em> (pp. 281–306). Oxford University Press.
</div>
<div id="ref-Hooten2024" class="csl-entry" role="listitem">
Hooten, M. B., Schwob, M. R., Johnson, D. S., &amp; Ivan, J. S. (2024). Geostatistical capture–recapture models. <em>Spatial Statistics</em>, <em>59</em>, 100817. <a href="https://doi.org/10.1016/j.spasta.2024.100817">https://doi.org/10.1016/j.spasta.2024.100817</a>
</div>
<div id="ref-Johnson2010" class="csl-entry" role="listitem">
Johnson, D. S., Laake, J. L., &amp; Ver Hoef, J. M. (2010). A model‐based approach for making ecological inference from distance sampling data. <em>Biometrics</em>, <em>66</em>(1), 310–318. <a href="https://doi.org/10.1111/j.1541-0420.2009.01265.x">https://doi.org/10.1111/j.1541-0420.2009.01265.x</a>
</div>
<div id="ref-Kendeigh1944" class="csl-entry" role="listitem">
Kendeigh, S. C. (1944). Measurement of bird populations. <em>Ecological Monographs</em>, <em>14</em>, 67–106. <a href="https://doi.org/10.2307/1961632">https://doi.org/10.2307/1961632</a>
</div>
<div id="ref-Moqanaki2021" class="csl-entry" role="listitem">
Moqanaki, E. M., Milleret, C., Tourani, M., Dupont, P., &amp; Bischof, R. (2021). Consequences of ignoring variable and spatially autocorrelated detection probability in spatial capture-recapture. <em>Landscape Ecology</em>, <em>36</em>(10), 2879–2895. <a href="https://doi.org/10.1007/s10980-021-01283-x">https://doi.org/10.1007/s10980-021-01283-x</a>
</div>
<div id="ref-Reich2014" class="csl-entry" role="listitem">
Reich, B. J., &amp; Gardner, B. (2014). A spatial capture‐recapture model for territorial species. <em>Environmetrics</em>, <em>25</em>(8), 630–637. <a href="https://doi.org/10.1002/env.2317">https://doi.org/10.1002/env.2317</a>
</div>
<div id="ref-Royle2013" class="csl-entry" role="listitem">
Royle, J. A., Chandler, R. B., Sun, C. C., &amp; Fuller, A. K. (2013). Integrating resource selection information with spatial capture–recapture. <em>Methods in Ecology and Evolution</em>, <em>4</em>(6), 520–530. <a href="https://doi.org/10.1111/2041-210x.12039">https://doi.org/10.1111/2041-210x.12039</a>
</div>
<div id="ref-Schlather2015" class="csl-entry" role="listitem">
Schlather, M., Malinowski, A., Menck, P. J., Oesting, M., &amp; Strokorb, K. (2015). Analysis, simulation and prediction of multivariate random fields with package RandomFields. <em>Journal of Statistical Software</em>, <em>63</em>(8). <a href="https://doi.org/10.18637/jss.v063.i08">https://doi.org/10.18637/jss.v063.i08</a>
</div>
<div id="ref-Stevenson2021" class="csl-entry" role="listitem">
Stevenson, B. C., Fewster, R. M., &amp; Sharma, K. (2021). Spatial correlation structures for detections of individuals in spatial capture–recapture models. <em>Biometrics</em>, <em>78</em>(3), 963–973. <a href="https://doi.org/10.1111/biom.13502">https://doi.org/10.1111/biom.13502</a>
</div>
</div>
</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="./16-sex.html" class="pagination-link" aria-label="Sex differences">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Sex differences</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./A01-troubleshooting.html" class="pagination-link" aria-label="Troubleshooting **secr**">
        <span class="nav-page-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Troubleshooting <strong>secr</strong></span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"loop":false,"descPosition":"bottom","closeEffect":"zoom","openEffect":"zoom","selector":".lightbox"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>


</body></html>