<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Spatially Explicit Capture–Recapture - 10&nbsp; Detection model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./11-density-model.html" rel="next">
<link href="./09-secr-package.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script><script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">
<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./09-secr-package.html">Practice</a></li><li class="breadcrumb-item"><a href="./10-detection-model.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Detection model</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Spatially Explicit Capture–Recapture</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/MurrayEfford/SECRbook" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Foreword</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Basics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Concepts and terminology</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-example.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Simple example</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Theory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Likelihood-based SECR</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-theory-area-search.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Area search</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-theory-special-topics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Special topics</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Performance</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Assumptions and robustness</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-validation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Empirical validation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-studydesign.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Study design</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Practice</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-secr-package.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">R package secr</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-detection-model.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Detection model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-density-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Density model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-habitat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Habitat mask</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-fittedmodels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Working with fitted models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-multisession.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Multiple sessions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-finite-mixtures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Individual heterogeneity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-sex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Sex differences</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Simulation</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A01-troubleshooting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Troubleshooting <strong>secr</strong></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A02-speed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Faster is better</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A03-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Spatial data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A04-polygondetectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Area and transect search</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A05-mark-resight.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Mark-resight models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A06-noneuclidean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Non-Euclidean distances</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A07-telemetry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Telemetry</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A08-parameterizations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Parameterizations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A09-densityappendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Density revisited</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A10-trend.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Trend revisited</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A11-expected-counts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Expected counts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A12-datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Datasets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A99-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
<li><a href="#sec-detectfn" id="toc-sec-detectfn" class="nav-link active" data-scroll-target="#sec-detectfn"><span class="header-section-number">10.1</span> Distance-detection functions</a></li>
  <li><a href="#linear-submodels" id="toc-linear-submodels" class="nav-link" data-scroll-target="#linear-submodels"><span class="header-section-number">10.2</span> Detection submodels</a></li>
  <li><a href="#varying-effort" id="toc-varying-effort" class="nav-link" data-scroll-target="#varying-effort"><span class="header-section-number">10.3</span> Varying effort</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./09-secr-package.html">Practice</a></li><li class="breadcrumb-item"><a href="./10-detection-model.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Detection model</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-detection" class="quarto-section-identifier"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Detection model</span></span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header><p>The detection model in SECR most commonly models the probability that an individual with a particular activity centre will be detected on a particular occasion at a particular place (detector). If the detector type allows for multiple detections (cues or visits) the model describes the number of detections rather than probability.</p>
<p>A bare-bones detection model is a distance-detection function (or simply ‘detection function’) with two parameters, intercept and spatial scale. There are three sources of complexity and opportunities for customisation:</p>
<ul>
<li>function shape (e.g., halfnormal vs negative exponential) and whether it describes the probability or hazard of detection,</li>
<li>parameters may depend on other known variables, and</li>
<li>parameters may be modelled as random effects to represent variation of unknown origin.</li>
</ul>
<p>We consider the shape of detection functions in the next section. Modelling parameters as a function of other variables is addressed in the following section on <a href="#linear-submodels">linear submodels</a>. Random effects in <strong>secr</strong> are limited to finite mixture models that we cover in the chapter on <a href="15-finite-mixtures.html">individual heterogeneity</a>.</p>
<section id="sec-detectfn" class="level2" data-number="10.1"><h2 data-number="10.1" class="anchored" data-anchor-id="sec-detectfn">
<span class="header-section-number">10.1</span> Distance-detection functions</h2>
<p></p>
<p>The probability of detection <span class="math inline">g(d)</span> at a detector distance <span class="math inline">d</span> from an activity centre may take one of the simple forms in <a href="#tbl-detectfn" class="quarto-xref">Table&nbsp;<span>10.1</span></a>. Alternatively, the probability of detection may be derived from <span class="math inline">g(d) = 1 - \exp[-\lambda(d)]</span> where <span class="math inline">\lambda(d)</span> is the hazard of detection, itself modelled with one of the simple parametric forms (<a href="#tbl-hazarddetectfn" class="quarto-xref">Table&nbsp;<span>10.2</span></a>)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. Several further options are provided by <code>secr.fit</code> (see <code>? detectfn</code>), but only ‘HN’,‘HR’, and ‘EX’ or their ‘hazard’ equivalents are commonly used.</p>
<p><br></p>
<div id="tbl-detectfn" class="sm quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-detectfn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10.1: Probability detection functions.
</figcaption><div aria-describedby="tbl-detectfn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-sm small table">
<colgroup>
<col style="width: 8%">
<col style="width: 30%">
<col style="width: 14%">
<col style="width: 48%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Code</th>
<th style="text-align: left;">Name</th>
<th style="text-align: left;">Parameters</th>
<th style="text-align: left;">Function</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">HN</td>
<td style="text-align: left;">halfnormal</td>
<td style="text-align: left;"><span class="math inline">g_0, \sigma</span></td>
<td style="text-align: left;"><span class="math inline">g(d) = g_0 \exp \left(\frac{-d^2} {2\sigma^2} \right)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">HR</td>
<td style="text-align: left;">hazard rate<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>
</td>
<td style="text-align: left;"><span class="math inline">g_0, \sigma, z</span></td>
<td style="text-align: left;"><span class="math inline">g(d) = g_0 [1 - \exp\{{-(^d/_\sigma)^{-z}} \}]</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">EX</td>
<td style="text-align: left;">exponential</td>
<td style="text-align: left;"><span class="math inline">g_0, \sigma</span></td>
<td style="text-align: left;"><span class="math inline">g(d) = g_0  \exp \{-(^d/_\sigma) \}</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p><br></p>
<div id="tbl-hazarddetectfn" class="sm quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-hazarddetectfn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10.2: Hazard detection functions.
</figcaption><div aria-describedby="tbl-hazarddetectfn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-sm small table">
<colgroup>
<col style="width: 8%">
<col style="width: 33%">
<col style="width: 14%">
<col style="width: 43%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Code</th>
<th style="text-align: left;">Name</th>
<th style="text-align: left;">Parameters</th>
<th style="text-align: left;">Function</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">HHN</td>
<td style="text-align: left;">hazard halfnormal</td>
<td style="text-align: left;"><span class="math inline">\lambda_0, \sigma</span></td>
<td style="text-align: left;"><span class="math inline">\lambda(d) = \lambda_0 \exp \left(\frac{-d^2} {2\sigma^2} \right)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">HHR</td>
<td style="text-align: left;">hazard hazard rate</td>
<td style="text-align: left;"><span class="math inline">\lambda_0, \sigma, z</span></td>
<td style="text-align: left;"><span class="math inline">\lambda(d) = \lambda_0 (1 - \exp \{ -(^d/_\sigma)^{-z} \})</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">HEX</td>
<td style="text-align: left;">hazard exponential</td>
<td style="text-align: left;"><span class="math inline">\lambda_0, \sigma</span></td>
<td style="text-align: left;"><span class="math inline">\lambda(d)  = \lambda_0 \exp \{ -(^d/_\sigma) \}</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">HVP</td>
<td style="text-align: left;">hazard variable power</td>
<td style="text-align: left;"><span class="math inline">\lambda_0, \sigma, z</span></td>
<td style="text-align: left;"><span class="math inline">\lambda(d) = \lambda_0 \exp \{ -(^d/_\sigma)^{z} \}</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>The merits of focussing on the hazard<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> are a little arcane. We list them here:</p>
<ol type="1">
<li>Quantities on the hazard scale are additive and more tractable for some purposes (e.g.&nbsp;adjusting for effort, computing <a href="#Expected">expected counts</a>).</li>
<li>For some detector types (e.g., Poisson counts) the data are integers, for which <span class="math inline">\lambda(d)</span> has a direct interpretation as the expected count. However, <span class="math inline">\lambda(d)</span> can always be derived from <span class="math inline">g(d)</span> (<span class="math inline">\lambda(d) = -\log[1 - g(d)]</span>).</li>
<li>Intuitively, there is a close proportionality between <span class="math inline">\lambda(d)</span> and the height of an individual’s utilization pdf.</li>
</ol>
<p>The ‘hazard variable power’ function[^whynoVP] is a 3-parameter function modelled on that of <span class="citation" data-cites="Ergon2013">Ergon &amp; Gardner (<a href="A99-references.html#ref-Ergon2013" role="doc-biblioref">2013</a>)</span>. The third parameter allows for smooth variation of shape, including both HHN (<span class="math inline">z = 2</span>) and HEX (<span class="math inline">z = 1</span>) as special cases.</p>
<!-- [^whynoVP]: The lack in **secr** of a probability function with variable power $g(d) = g_0 \exp \{ -(^d/_\sigma)^{z} \}$ is an historical accident (the obvious integer codes had been allocated, and attention had shifted to hazard functions, hence HVP). Maybe there will be a function VP in future. -->
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Using the ‘complementary log-log’ link function cloglog for a hazard detection function such as <span class="math inline">\lambda(d) = \lambda_0 \exp[-d^2/(2\sigma^2)]</span> is equivalent to modelling <span class="math inline">\lambda</span> with a log link, as <span class="math inline">p = 1 - \exp(-\lambda)</span> and <span class="math inline">\lambda = -\log(1-p)</span>. For a halfnormal function, the quantity <span class="math inline">y</span> on the cloglog scale is then a linear function of <span class="math inline">\exp(-d^2)</span> with intercept <span class="math inline">\alpha_0 = \log(\lambda_0)</span> and slope <span class="math inline">\alpha_1 = -1/(2\sigma^2)</span> <span class="citation" data-cites="Royle2013">(e.g., <a href="A99-references.html#ref-Royle2013" role="doc-biblioref">Royle et al., 2013</a>)</span>.</p>
</div>
</div>
<section id="choice-of-detection-function-not-critical" class="level3" data-number="10.1.1"><h3 data-number="10.1.1" class="anchored" data-anchor-id="choice-of-detection-function-not-critical">
<span class="header-section-number">10.1.1</span> Choice of detection function not critical</h3>
<p>The variety of detection functions is daunting. You could try them all and select the “best” by AIC, but we do not recommend this. Fortunately, the choice of function is not critical. We illustrate this with the <a href="02-example.html">snowshoe hare dataset</a> and <code>list.secr.fit</code><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>. Warnings due to the use of a multi-catch likelihood for single-catch traps are suppressed both here and in other examples.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'HHN'</span>,<span class="st">'HHR'</span>,<span class="st">'HEX'</span>,<span class="st">'HVP'</span><span class="op">)</span></span>
<span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="fu">list.secr.fit</span><span class="op">(</span>detectfn <span class="op">=</span> <span class="va">df</span>, constant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>capthist <span class="op">=</span> <span class="va">hareCH6</span>, </span>
<span>              buffer <span class="op">=</span> <span class="fl">250</span>, trace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, names <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-choicedfplot" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-choicedfplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="10-detection-model_files/figure-html/fig-choicedfplot-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" data-glightbox="description: .lightbox-desc-1"><img src="10-detection-model_files/figure-html/fig-choicedfplot-1.png" class="img-fluid figure-img" style="width:60.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-choicedfplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.1: Four detection functions fitted to snowshoe hare data.
</figcaption></figure>
</div>
</div>
</div>
<p>The relative fit of the HHR, HVP and HEX models is essentially the same, whereas HHN is distinctly worse:</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">fits</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">7</span>,<span class="fl">8</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">##                  detectfn npar  logLik   dAIC  AICwt</span></span>
<span><span class="co">## HHR    hazard hazard rate    4 -599.68  0.000 0.5474</span></span>
<span><span class="co">## HVP hazard variable power    4 -600.43  1.487 0.2603</span></span>
<span><span class="co">## HEX    hazard exponential    3 -601.73  2.092 0.1923</span></span>
<span><span class="co">## HHN     hazard halfnormal    3 -608.07 14.783 0.0000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-choicedfparmplot" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-choicedfparmplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="10-detection-model_files/figure-html/fig-choicedfparmplot-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" data-glightbox="description: .lightbox-desc-2"><img src="10-detection-model_files/figure-html/fig-choicedfparmplot-1.png" class="img-fluid figure-img" width="720"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-choicedfparmplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.2: Parameter estimates from four detection functions (95% CI).
</figcaption></figure>
</div>
</div>
</div>
<p>The third parameter <span class="math inline">z</span> was estimated as 3.08 for HHR, and 0.67 for HVP.</p>
<p>Fitting the HVP function with <span class="math inline">z</span> fixed to different values is another way to examine the effect of shape (<a href="#fig-HVPvaryzplot" class="quarto-xref">Fig.&nbsp;<span>10.3</span></a>). Density estimates ranged only from 1.47 to 1.42.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-HVPvaryzplot" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-HVPvaryzplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="10-detection-model_files/figure-html/fig-HVPvaryzplot-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" data-glightbox="description: .lightbox-desc-3"><img src="10-detection-model_files/figure-html/fig-HVPvaryzplot-1.png" class="img-fluid figure-img" style="width:60.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-HVPvaryzplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.3: HVP function fitted to snowshoe hare data with <span class="math inline">z</span> parameter fixed at four different values.
</figcaption></figure>
</div>
</div>
</div>
<p>How can different functions produce nearly the same estimates? Remember that <a href="./05-theory-special-topics.html#esa"><span class="math inline">\hat D = n/a(\hat \theta)</span></a>, and <span class="math inline">n</span> is the same for all models. Constant <span class="math inline">\hat D</span> therefore implies constant effective sampling area <span class="math inline">a(\hat \theta)</span>. In other words, variation in <span class="math inline">\hat \lambda_0</span> and <span class="math inline">\hat \sigma</span> ‘washes out’ when they are combined in <span class="math inline">a(\hat \theta)</span>. Under the four models <span class="math inline">a(\hat \theta)</span> is estimated as 46.4, 48.4, 45.9 and 46.7 ha.</p>
</section><section id="detection-parameters-are-nuisance-parameters-mostly" class="level3" data-number="10.1.2"><h3 data-number="10.1.2" class="anchored" data-anchor-id="detection-parameters-are-nuisance-parameters-mostly">
<span class="header-section-number">10.1.2</span> Detection parameters are nuisance parameters (mostly)</h3>
<p>The detection model and its parameters (<span class="math inline">g_0</span>, <span class="math inline">\lambda_0</span>, <span class="math inline">\sigma</span> etc.) provide the link between our observations and the state of the animal population represented by the parameter <span class="math inline">D</span> (density, distribution in space, trend etc.). Submodels for <span class="math inline">D</span> are considered in <a href="11-density-model.html" class="quarto-xref"><span>Chapter 11</span></a>. But what interpretation should we attach to the detection parameters themselves?</p>
<p>The intercept <span class="math inline">g_0</span> is in a sense the probability of that an animal will be detected at the centre of its home range. The spatial scale of detection <span class="math inline">\sigma</span> relates to the size of the home range. These attributed meanings can aid intuitive understanding. However, we advise against a literal reading. The estimates have meaning only for a specified detection function and cannot meaningfully be compared across functions. Observe the</p>
<p>The halfnormal function is closest to a standard reference, but estimates of halfnormal <span class="math inline">\sigma</span> are sensitive to infrequent large movements. Care is also needed because some early writers omitted the factor 2 from the denominator, increasing estimates of <span class="math inline">\sigma</span> by <span class="math inline">\sqrt 2</span><a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>.</p>
<p>Continuing the snowshoe hare example: the estimates of <span class="math inline">\lambda_0</span> and <span class="math inline">\sigma</span> from HVP are surprisingly uncertain when considered on their own, yet the HVP estimate of density has about the same precision as other detection functions (<a href="#fig-choicedfparmplot" class="quarto-xref">Fig.&nbsp;<span>10.2</span></a>). How can this be? There is strong covariation in the sampling distributions of the two parameters that we plot using <code>ellipse.secr</code> in <a href="#fig-ellipseHVP" class="quarto-xref">Fig.&nbsp;<span>10.4</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ellipseHVP" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ellipseHVP-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="10-detection-model_files/figure-html/fig-ellipseHVP-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" data-glightbox="description: .lightbox-desc-4"><img src="10-detection-model_files/figure-html/fig-ellipseHVP-1.png" class="img-fluid figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ellipseHVP-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.4: Confidence ellipse for HVP detection parameters plotted on the link scale and back-transformed to natural scale. ‘+’ indicates MLE.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="secr-is-not-distance-sampling" class="level3" data-number="10.1.3"><h3 data-number="10.1.3" class="anchored" data-anchor-id="secr-is-not-distance-sampling">
<span class="header-section-number">10.1.3</span> SECR is not distance sampling</h3>
<p>The idea of a distance-detection function originated in distance sampling <span class="citation" data-cites="bablbt01">(<a href="A99-references.html#ref-bablbt01" role="doc-biblioref">Buckland et al., 2001</a>)</span> and <span class="citation" data-cites="Borchers2015">Borchers et al. (<a href="A99-references.html#ref-Borchers2015" role="doc-biblioref">2015</a>)</span> provided a unified framework for spatially explicit capture–recapture and distance sampling. Nevertheless, the role of the detection function differs substantially.</p>
<p>In distance sampling, shape matters a lot. In particular, the estimate of density depends on the slope of the detection function near the origin, given the assumption that all animals at the origin are detected <span class="citation" data-cites="Buckland2015">(e.g., <a href="A99-references.html#ref-Buckland2015" role="doc-biblioref">Buckland et al., 2015</a>)</span>.</p>
<p>In SECR, no special significance is attached to the intercept or the shape of the function. The detection function serves as a spatial filter for a modelled 2-dimensional point pattern of activity centres; the filter must ‘explain’ the frequency of recaptures and their spatial spread. These are the components of the effective sampling area.</p>
<p>The hazard-rate function HR is recommended for distance sampling because it has a distinct ‘shoulder’ near zero distance, and distance sampling is not concerned with the tail (distant observations are often censored). SECR relies on the tail flattening to zero within the region of integration (<a href="12-habitat.html">habitat mask</a>). Otherwise, the population at risk of detection is determined by the choice of mask, which is usually arbitrary and <em>ad hoc</em>. The hazard-rate function has an extremely long tail (it is not convergent), so there is always a risk of mask-dependence. As an aside - in the snowshoe hare example with detection function HHR we suppressed the warning “predicted relative bias exceeds 0.01 with buffer = 250” that is due to truncation of the long tail.</p>
</section><section id="whybother1" class="level3" data-number="10.1.4"><h3 data-number="10.1.4" class="anchored" data-anchor-id="whybother1">
<span class="header-section-number">10.1.4</span> Why bother?</h3>
<p>Given the preceding comments you may wonder why we bother with different detection functions at all. In part this is historical: it was not obvious in the beginning that density estimates were so robust. Sometimes it’s just nice to have the flexibility to match the model to animal behaviour. Functions with longer tails (e.g., HEX) accommodate occasional extreme movements that can prevent a short-tailed function (HHN) from fitting at all.</p>
<p>Also, it is desirable to account for any significant lack of fit due to the detection function before modelling effects that may have a more critical effect on density estimates, such as individual heterogeneity and learned responses.</p>
</section></section><section id="linear-submodels" class="level2" data-number="10.2"><h2 data-number="10.2" class="anchored" data-anchor-id="linear-submodels">
<span class="header-section-number">10.2</span> Detection submodels</h2>
<p></p>
<p>Until now we have assumed that there is a single beta parameter for each real parameter. A much richer set of models is obtained by treating each real parameter as a function of covariates. For convenience, the function is linear on the appropriate <a href="./01-basics.html#sec-link">link</a> scale. The single ‘beta’ coefficient is then replaced by two or more coefficients (e.g., intercept <span class="math inline">\beta_0</span> and slope <span class="math inline">\beta_1</span> of the linear relationship <span class="math inline">y = \beta_0 + \beta_1x_1</span> where <span class="math inline">y</span> is a parameter on the link scale and <span class="math inline">x_1</span> is a covariate). Suppose, for example, that <span class="math inline">y</span> depends on sampling occasion <span class="math inline">s</span> then <span class="math inline">y(s) = \beta_0 + \beta_1x_1(s)</span> and the corresponding real parameter is <span class="math inline">y(s)</span> back transformed from the link scale.</p>
<p>This may be generalised using the notation of linear models, <span id="eq-linearmodel"><span class="math display">
\mathbf y = \mathbf X \pmb {\beta},
\tag{10.1}</span></span></p>
<p>where <span class="math inline">\mathbf X</span> is the design matrix, <!-- rather than \pmb from amsmath, can use \boldsymbol for HTML, \symbf for pdf --> <span class="math inline">\pmb{\beta}</span> is a vector of coefficients, and <span class="math inline">\mathbf y</span> is the resulting vector of values on the link scale, one for each row of <span class="math inline">\mathbf X</span>. The first column of the design matrix is a column of 1’s for the intercept <span class="math inline">\beta_0</span>. Factor (categorical) predictors will usually be represented by several columns of indicator values (0’s and 1’s coding factor levels). See <span class="citation" data-cites="cw">Cooch &amp; White (<a href="A99-references.html#ref-cw" role="doc-biblioref">2023</a>)</span> Chapter 6 for an accessible introduction to linear models and design matrices.</p>
<p>In <strong>secr</strong> each detection parameter (<span class="math inline">g_0, \lambda_0, \sigma, z</span>) is controlled by a linear submodel on its link scale, i.e.&nbsp;each has its own design matrix. <em>Rows</em> of the design matrix correspond to combinations of session, individual, occasion, and detector, omitting any of these four that is constant (perhaps because there is only one level). Finite-mixture models add further rows to the design matrix that we leave aside for now. <em>Columns</em> after the first are either (i) indicators to represent effects that can be constructed automatically (<a href="#tbl-predictors" class="quarto-xref">Table&nbsp;<span>10.3</span></a>), or (ii) user-supplied covariates associated with sessions, individuals, occasions or detectors.</p>
<div id="tbl-predictors" class="sm quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-predictors-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10.3: Automatically generated predictor variables for detection models
</figcaption><div aria-describedby="tbl-predictors-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-sm small table">
<thead><tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Notes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">g</td>
<td style="text-align: left;">group</td>
<td style="text-align: left;">
<a href="05-theory-special-topics.html#groups">groups</a> are defined by the individual covariate(s) named in the ‘groups’ argument</td>
</tr>
<tr class="even">
<td style="text-align: left;">t</td>
<td style="text-align: left;">time factor</td>
<td style="text-align: left;">one level for each occasion</td>
</tr>
<tr class="odd">
<td style="text-align: left;">T</td>
<td style="text-align: left;">time trend</td>
<td style="text-align: left;">linear trend over occasions on link scale</td>
</tr>
<tr class="even">
<td style="text-align: left;">b</td>
<td style="text-align: left;">learned response</td>
<td style="text-align: left;">step change after first detection</td>
</tr>
<tr class="odd">
<td style="text-align: left;">B</td>
<td style="text-align: left;">transient response</td>
<td style="text-align: left;">depends on detection at preceding occasion (Markovian response)</td>
</tr>
<tr class="even">
<td style="text-align: left;">bk</td>
<td style="text-align: left;">animal x site response</td>
<td style="text-align: left;">site-specific step change</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bk</td>
<td style="text-align: left;">animal x site response</td>
<td style="text-align: left;">site-specific transient response</td>
</tr>
<tr class="even">
<td style="text-align: left;">k</td>
<td style="text-align: left;">site learned response</td>
<td style="text-align: left;">site effectiveness changes once any animal caught</td>
</tr>
<tr class="odd">
<td style="text-align: left;">K</td>
<td style="text-align: left;">site transient response</td>
<td style="text-align: left;">site effectiveness depends on preceding occasion</td>
</tr>
<tr class="even">
<td style="text-align: left;">session</td>
<td style="text-align: left;">session factor</td>
<td style="text-align: left;">one level for each session</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Session</td>
<td style="text-align: left;">session trend</td>
<td style="text-align: left;">linear trend on link scale</td>
</tr>
<tr class="even">
<td style="text-align: left;">h2</td>
<td style="text-align: left;">2-class mixture</td>
<td style="text-align: left;">
<a href="05-theory-special-topics.html#finite-mixtures">finite mixture model</a> with 2 latent classes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ts</td>
<td style="text-align: left;">marking vs sighting</td>
<td style="text-align: left;">two levels (marking and sighting occasions)</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Each design matrix is constructed automatically when <code>secr.fit</code> is called, using the data and a model formula. Computation of the linear predictor (<a href="#eq-linearmodel" class="quarto-xref">Eq.&nbsp;<span>10.1</span></a>) and back-transformation to the real scale are also automatic: the user need never see the design matrix.</p>
<p>The hard-wired structure of the design matrices precludes some possible submodels: there is no direct way to model <em>spatial</em> variation in a detection parameter. However, spatial effects may be modelled using detector covariates, i.e.&nbsp;as a function of detector location rather than AC location, and a further workaround for parameter <span class="math inline">\sigma</span> is shown in <a href="A06-noneuclidean.html" class="quarto-xref"><span>Appendix F</span></a>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Linear submodels for parameters are considered by <span class="citation" data-cites="cw">Cooch &amp; White (<a href="A99-references.html#ref-cw" role="doc-biblioref">2023</a>)</span> as a <em>constraint</em> on a more general model. Their default is for each parameter to be fully-time-specific e.g., a Cormack-Jolly-Seber open population survival model would fit a unique detection probability <span class="math inline">p</span> and survival rate <span class="math inline">\phi</span> at each time. Our default is for each parameter to be constant (i.e.&nbsp;maximally constrained), and for linear submodels to introduce variation.</p>
</div>
</div>
<p>The formula may be constant (<span class="math inline">\sim</span> 1, the default) or some combination of terms in standard R formula notation (see <code><a href="https://rdrr.io/r/stats/formula.html">?formula</a></code>). For example, g0 <span class="math inline">\sim</span> b + T specifies a model with a learned response and a linear time trend in g0; the effects are additive on the link scale. <a href="#tbl-examples" class="quarto-xref">Table&nbsp;<span>10.4</span></a> has some examples.</p>
<div id="tbl-examples" class="sm quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-examples-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10.4: Some examples of the ‘model’ argument in <code>secr.fit</code>
</figcaption><div aria-describedby="tbl-examples-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-sm small table">
<colgroup>
<col style="width: 31%">
<col style="width: 68%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Formula</th>
<th style="text-align: left;">Effect</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">g0 <span class="math inline">\sim</span> 1</td>
<td style="text-align: left;">g0 constant across animals, occasions and detectors</td>
</tr>
<tr class="even">
<td style="text-align: left;">g0 <span class="math inline">\sim</span> b</td>
<td style="text-align: left;">learned response affects g0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">list(g0 <span class="math inline">\sim</span> b, sigma <span class="math inline">\sim</span> b)</td>
<td style="text-align: left;">learned response affects both g0 and sigma</td>
</tr>
<tr class="even">
<td style="text-align: left;">g0 <span class="math inline">\sim</span> h2</td>
<td style="text-align: left;">2-class finite mixture for heterogeneity in g0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">g0 <span class="math inline">\sim</span> b + T</td>
<td style="text-align: left;">learned response in g0 combined with trend over occasions</td>
</tr>
<tr class="even">
<td style="text-align: left;">sigma <span class="math inline">\sim</span> g</td>
<td style="text-align: left;">detection scale sigma differs between groups</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sigma <span class="math inline">\sim</span> g*T</td>
<td style="text-align: left;">group-specific trend in sigma</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<!-- Behavioural responses 'b', 'B', 'bk', and 'Bk' refer to individuals whereas 'k' and 'K' refer only to sites.  -->
<p>The common question of how to model sex differences can be answered in several ways. we devote <a href="16-sex.html" class="quarto-xref"><span>Chapter 16</span></a> to the possibilities (groups, individual covariate, hybrid mixtures etc.).</p>
<section id="covariates" class="level3" data-number="10.2.1"><h3 data-number="10.2.1" class="anchored" data-anchor-id="covariates">
<span class="header-section-number">10.2.1</span> Covariates</h3>
<p></p>
<p>Any name in a formula that is not listed as a variable in <a href="#tbl-predictors" class="quarto-xref">Table&nbsp;<span>10.3</span></a> is assumed to refer to a user-supplied covariate. <code>secr.fit</code> looks for user-supplied covariates in data frames embedded in the ‘capthist’ argument, or supplied in the ‘timecov’ and ‘sessioncov’ arguments, or named with the ‘timevaryingcov’ attribute of a traps object, using the first match (<a href="#tbl-covariates" class="quarto-xref">Table&nbsp;<span>10.5</span></a>).</p>
<div id="tbl-covariates" class="sm quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-covariates-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10.5: Types of user-provided covariate for parameters of detection models. The names of columns in the respective dataframes may be used in model formulae. Time-varying detector covariates are a special case considered below.
</figcaption><div aria-describedby="tbl-covariates-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-sm small table">
<thead><tr class="header">
<th style="text-align: left;">Covariate type</th>
<th style="text-align: left;">Data source</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Individual</td>
<td style="text-align: left;">covariates(capthist)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Time</td>
<td style="text-align: left;">timecov argument</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Detector</td>
<td style="text-align: left;">covariates(traps(capthist))</td>
</tr>
<tr class="even">
<td style="text-align: left;">Detector x Time</td>
<td style="text-align: left;">covariates(traps(capthist))</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Session</td>
<td style="text-align: left;">sessioncov argument</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<!-- [Hybrid mixture models](#hybrid-mixtures) allow some or all individuals to be assigned permanently to a group (mixture class), while other individuals (ideally a minority) may be of unknown class. -->
<p>A continuous covariate that takes many unique values poses problems for the implementation in <strong>secr</strong>. A multiplicity of values inflates the size of internal lookup tables, both slowing down each likelihood evaluation and potentially exceeding the available memory<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>. A binned covariate should do the job equally well, while saving time and space (see function <code>binCovariate</code> <strong>secr</strong> <span class="math inline">\ge</span> 4.6.5).</p>
</section><section id="time-varying-trap-covariates" class="level3" data-number="10.2.2"><h3 data-number="10.2.2" class="anchored" data-anchor-id="time-varying-trap-covariates">
<span class="header-section-number">10.2.2</span> Time-varying trap covariates</h3>
<p></p>
<p>A special mechanism is provided for detector-level covariates that take different values on each occasion. Then we expect the dataframe of detector covariates to include a column for each occasion.</p>
<p>A ‘traps’ object may have an attribute ‘timevaryingcov’ that is a list in which each named component is a vector of indices identifying which covariate column to use on each occasion. The name may be used in model formulae. Use <code>timevaryingcov()</code> to extract or replace the attribute.</p>
</section><section id="regression-splines" class="level3" data-number="10.2.3"><h3 data-number="10.2.3" class="anchored" data-anchor-id="regression-splines">
<span class="header-section-number">10.2.3</span> Regression splines</h3>
<p></p>
<p>Modelling a link-linear<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> relationship between a covariate and a parameter may be too restrictive.<br>
Regression splines are a very flexible way to represent non-linear responses in generalized additive models, implemented in the R package <strong>mgcv</strong> <span class="citation" data-cites="w06">(<a href="A99-references.html#ref-w06" role="doc-biblioref">Wood, 2006</a>)</span>. <span class="citation" data-cites="bk14">Borchers &amp; Kidney (<a href="A99-references.html#ref-bk14" role="doc-biblioref">2014</a>)</span> showed how they may be used to model 2-dimensional trend in density. They used <strong>mgcv</strong> to construct regression spline basis functions from mask x- and y-coordinates, and possibly additional mask covariates, and then passed these as covariates to <code>secr.fit</code>. Smooth, semi-parametric responses are also useful for modelling variation in detection parameters such as <span class="math inline">g_0</span> and <span class="math inline">\sigma</span> over time, or in response to numeric individual- or detector-level covariates, when (1) a linear or other parametric response is arbitrary or implausible, and (2) sampling spans a range of times or levels of the covariate(s).</p>
<p>Smooth terms may be used in <strong>secr</strong> model formulae for both density and detection parameters. The covariate is merely wrapped in a call to the smoother function <code>s()</code>. Smoothness is controlled by the argument ‘k’.</p>
<p>For a concrete example, consider a population sampled monthly for a year (i.e., 12 ‘sessions’). If home range size varies seasonally then the parameter sigma may vary in a more-or-less sinusoidal fashion. A linear trend is obviously inadequate, and a quadratic is not much better. However, a sine curve is hard to fit (we would need to estimate its phase, amplitude, mean and spatial scale) and assumes the increase and decrease phases are equally steep. An extreme solution is to treat month as a factor and estimate a separate parameter for each level (month). A smooth (semi-parametric) curve may capture the main features of seasonal variation with fewer parameters.</p>
<p>There are some drawbacks to using smooth terms. The resulting fitted objects are large, on account of the need to store setup information from <strong>mgcv</strong>. The implementation may change in later versions of <strong>mgcv</strong> and <strong>secr</strong>, and smooth models fitted now will not necessarily be compatible with later versions. Setting the intercept of a smooth to zero is not a canned option in <strong>mgcv</strong>, and is not offered in <strong>secr</strong>. It may be achieved by placing a knot at zero and hacking the matrix of basis functions to drop the corresponding column, plus some more jiggling.</p>
</section><section id="whybother2" class="level3" data-number="10.2.4"><h3 data-number="10.2.4" class="anchored" data-anchor-id="whybother2">
<span class="header-section-number">10.2.4</span> Why bother?</h3>
<p>Detailed modelling of detection parameters may be a waste of energy for the same reasons that the <a href="#whybother1">choice of detection function</a> itself has limited interest. See, for example, the simulation results of <span class="citation" data-cites="Sollmann2024">Sollmann (<a href="A99-references.html#ref-Sollmann2024" role="doc-biblioref">2024</a>)</span> on occasion-specific models (<span class="math inline">\sim</span> t). However, behavioural responses and individual heterogeneity can have a major effect on density estimates, and these deserve attention.</p>
<section id="behaviouralresponse" class="level4" data-number="10.2.4.1"><h4 data-number="10.2.4.1" class="anchored" data-anchor-id="behaviouralresponse">
<span class="header-section-number">10.2.4.1</span> Behavioural responses</h4>
<p></p>
<p>An individual behavioral response is a change in the probability or hazard of detection on the occasions that follow a detection. Trapping of small mammals provides evidence of species that routinely become trap happy (presumably because they enjoy the bait) or trap shy (presumably because the experience of capture and handling is unpleasant). Positive or negative responses are modelled as a step change in a detection parameter, usually the intercept of the detection function (<span class="math inline">g_0</span>, <span class="math inline">\lambda_0</span>).</p>
<p>The response may be permanent (b) or transient (B) (i.e.&nbsp;applying only on the next occasion). In spatial models we also distinguish between a global response, across all detectors, and a local response, specific to the initial detector (suffix ‘k’). This leads to four response models: b, bk, B, and Bk.</p>
<p>We explore these options with Reid’s Wet Swizer Gulch deer mouse (<em>Peromyscus maniculatus</em>) dataset from <span class="citation" data-cites="obwa78">Otis et al. (<a href="A99-references.html#ref-obwa78" role="doc-biblioref">1978</a>)</span>. Mice were trapped on a grid of 99 traps over 6 days. The Sherman traps were treated as multi-catch traps for this analysis. We fit the four behavioural response models and the null model to the morning data.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cmod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'g0~'</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'1'</span>,<span class="st">'b'</span>,<span class="st">'B'</span>,<span class="st">'bk'</span>,<span class="st">'Bk'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># convert each character string to a formula and fit the models</span></span>
<span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="fu">list.secr.fit</span><span class="op">(</span>model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">cmod</span>, <span class="va">formula</span><span class="op">)</span>, constant <span class="op">=</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>capthist <span class="op">=</span> <span class="st">'deermouse.WSG'</span>, trace <span class="op">=</span> <span class="cn">FALSE</span>, buffer <span class="op">=</span> <span class="fl">80</span><span class="op">)</span>, </span>
<span>    names <span class="op">=</span> <span class="va">cmod</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">fits</span>, sort <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">7</span>,<span class="fl">8</span><span class="op">)</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      npar  logLik    AIC    dAIC AICwt
g0~1     3 -663.54 1333.1 129.938     0
g0~b     4 -643.72 1295.4  92.298     0
g0~B     4 -651.62 1311.2 108.099     0
g0~bk    4 -597.57 1203.1   0.000     1
g0~Bk    4 -621.02 1250.0  46.910     0</code></pre>
</div>
</div>
<p>All response models are preferred to the null model, but the differences among them are marked: the evidence supports a persistent local response (bk). The density estimates for bk and Bk are close to the null model, whereas the b and B estimates are greater. In our experience this is a common result: a local response is preferred by AIC and has less impact on density estimates than a global response, and there is little penalty for omitting the response from the model.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">collate</span><span class="op">(</span><span class="va">fits</span>, realnames <span class="op">=</span> <span class="st">'D'</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>,,,<span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      estimate SE.estimate    lcl    ucl
g0~1    14.089      2.0364 10.629 18.676
g0~b    18.531      3.3459 13.044 26.324
g0~B    15.726      2.3351 11.774 21.005
g0~bk   13.884      2.1108 10.324 18.672
g0~Bk   13.883      2.0472 10.414 18.506</code></pre>
</div>
</div>
<p>The estimated magnitude of the responses may be examined with <code>predict(fits[2:5], all.levels = TRUE)</code> but the output is long and we show only the global (b) and local (bk) enduring responses:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>$`g0~b`
                     estimate   lcl   ucl
session = WSG, b = 0    0.055 0.031 0.096
session = WSG, b = 1    0.210 0.163 0.267

$`g0~bk`
                      estimate   lcl   ucl
session = WSG, bk = 0    0.061 0.044 0.085
session = WSG, bk = 1    0.596 0.454 0.723</code></pre>
</div>
</div>
<p>Here ‘b = 0’ and ‘bk = 0’ refer to <span class="math inline">g_0</span> for a naive animal and ‘b = 1’ and ‘bk = 1’ refer to the post-detection values (estimates are shown with 95% limits). It appears that deermice are highly likely to return to traps where they have been caught.</p>
<p>Detector-level ‘behavioural’ response is also possible (predictors k, K in <code>secr.fit</code>). Detection of any individuals at a detector may in principle be facilitated or inhibited by a previous detection there of any other individual. We are not aware of published examples.</p>
<p>The trap-facilitation model fitted to the deer mouse data results in a larger and less precise estimate of density (16.78/ha, SE 2.59/ha), with AIC intermediate between the null model and bk (facilitation model <span class="math inline">\Delta</span>AIC = 73.7 relative to bk). There is a risk of confusing such an effect with simple heterogeneity in the performance of detectors or clumping of activity centres or an individual local response (bk). More investigation is needed.</p>
</section></section></section><section id="varying-effort" class="level2" data-number="10.3"><h2 data-number="10.3" class="anchored" data-anchor-id="varying-effort">
<span class="header-section-number">10.3</span> Varying effort</h2>
<p></p>
<p>Researchers are often painfully aware of glitches in their data gathering - traps that were not set, sampling occasions missed or delayed due to weather etc. Even when the actual estimates are robust, as in an example below, it is desirable (therapeutic and scientific) to allow for known irregularities in the data. This is the role of the ‘usage’ matrix as <a href="./03-theory.html#varying-effort">described</a> in <a href="03-theory.html" class="quarto-xref"><span>Chapter 3</span></a>.</p>
<p>The ‘usage’ attribute of a ‘traps’ object in <strong>secr</strong> is a <span class="math inline">K</span> x <span class="math inline">S</span> matrix recording the effort (<span class="math inline">T_{sk}</span>) at each detector <span class="math inline">k = 1...K</span> and occasion <span class="math inline">s = 1...S</span>. Effort may be binary (0/1) or continuous. If the attribute is missing (NULL) it will be treated as all ones. Extraction and replacement functions are provided (<code>usage</code> and <code>usage&lt;-</code>, as demonstrated below). All detector types accept usage data in the same format<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>. Binomial count detectors are a special case: when the <code>secr.fit</code> argument binomN = 1, or equivalently binomN = ‘usage’, usage is interpreted as the size of the binomial distribution.</p>
<p>Usage data may be input as extra columns in a file of detector coordinates (see <code>?read.traps</code> and <a href="https://www.otago.ac.nz/density/pdfs/secr-datainput.pdf">secr-datainput.pdf</a>.</p>
<p>Usage data also may be added to an existing traps object, even after it has been included in a capthist object. For example, the traps object in the demonstration dataset ‘captdata’ starts with no usage attribute, but we can add one. Suppose that traps 14 and 15 were not set on occasions 1–3. We construct a binary usage matrix and assign it to the traps object like this:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="fu">traps</span><span class="op">(</span><span class="va">captdata</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">captdata</span><span class="op">)</span></span>
<span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span>, nrow <span class="op">=</span> <span class="va">K</span>, ncol <span class="op">=</span> <span class="va">S</span><span class="op">)</span></span>
<span><span class="va">mat</span><span class="op">[</span><span class="fl">14</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span>   <span class="co"># traps 14:15 not set on occasions 1:3</span></span>
<span><span class="fu">usage</span><span class="op">(</span><span class="fu">traps</span><span class="op">(</span><span class="va">captdata</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">mat</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="models" class="level3" data-number="10.3.1"><h3 data-number="10.3.1" class="anchored" data-anchor-id="models">
<span class="header-section-number">10.3.1</span> Models</h3>
<p>The usage attribute of a traps object is applied automatically by <code>secr.fit</code>. Following on from the preceding example, we can confirm our assignment and fit a new model.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu">traps</span><span class="op">(</span><span class="va">captdata</span><span class="op">)</span><span class="op">)</span>    <span class="co"># confirm usage attribute</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Object class       traps 
Detector type      single 
Detector number    100 
Average spacing    30 m 
x-range            365 635 m 
y-range            365 635 m 

Usage range by occasion
    1 2 3 4 5
min 0 0 0 1 1
max 1 1 1 1 1</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">secr.fit</span><span class="op">(</span><span class="va">captdata</span>, buffer <span class="op">=</span> <span class="fl">100</span>, trace <span class="op">=</span> <span class="cn">FALSE</span>, biasLimit <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       link estimate SE.estimate      lcl      ucl
D       log  5.47346    0.645991  4.34659  6.89249
g0    logit  0.27473    0.027164  0.22479  0.33102
sigma   log 29.39668    1.308422 26.94206 32.07494</code></pre>
</div>
</div>
<p>The result in this case is only subtly different from the model with uniform usage (compare <code>predict(secrdemo.0)</code>). Setting <code>biasLimit = NA</code> avoids a warning message from <code>secr.fit</code> regarding <code>bias.D</code>: this function is usually run by <code>secr.fit</code> after any model fit using the ‘buffer’ argument, but it does not handle varying effort.</p>
<p>Usage is hardwired and will be applied whenever a model is fitted. There are two ways to suppress this. The first is to remove the usage attribute (<code>usage(traps(captdata)) &lt;- NULL</code>). The second is to bypass the attribute for a single fit by calling <code>secr.fit</code> with ‘details = list(ignoreusage = TRUE)’.</p>
<p>For a more informative example, we simulate data from an array of binary proximity detectors (such as automatic cameras) operated over 5 occasions, using the default density (5/ha) and detection parameters (g0 = 0.1, sigma = 25 m) in <code>sim.capthist</code>. We choose to expose all detectors twice as long on occasions 2 and 3 as on occasion 1, and three times as long on occasions 4 and 5:</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">simgrid</span> <span class="op">&lt;-</span> <span class="fu">make.grid</span><span class="op">(</span>nx <span class="op">=</span> <span class="fl">10</span>, ny <span class="op">=</span> <span class="fl">10</span>, detector <span class="op">=</span> <span class="st">'proximity'</span><span class="op">)</span></span>
<span><span class="fu">usage</span><span class="op">(</span><span class="va">simgrid</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="fl">100</span>, </span>
<span>    ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">simCH</span> <span class="op">&lt;-</span> <span class="fu">sim.capthist</span><span class="op">(</span><span class="va">simgrid</span>, popn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>D <span class="op">=</span> <span class="fl">5</span>, buffer <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, </span>
<span>    detectpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>g0 <span class="op">=</span> <span class="fl">0.1</span>, sigma <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>, noccasions <span class="op">=</span> <span class="fl">5</span>, </span>
<span>    seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">simCH</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Object class       capthist 
Detector type      proximity (5) 
Detector number    100 
Average spacing    20 m 
x-range            0 180 m 
y-range            0 180 m 

Usage range by occasion
    1 2 3 4 5
min 1 2 2 3 3
max 1 2 2 3 3

Counts by occasion 
                    1   2   3   4   5 Total
n                  15  18  23  29  23   108
u                  15   7   6   7   1    36
f                   8   6   9   4   9    36
M(t+1)             15  22  28  35  36    36
losses              0   0   0   0   0     0
detections         26  32  39  54  55   206
detectors visited  24  28  33  41  44   170
detectors used    100 100 100 100 100   500</code></pre>
</div>
</div>
<p>Now we fit four models with a half-normal detection function. The firest model (fit.null) has no adjustment because we ignore the usage information. The second (fit.usage) automatically adjusts for effort. The third (fit.tcov1) again ignores effort, but fits a distinct g0 for each level of effort. The fourth (fit.tcov2) uses a numerical covariate equal to the known effort. The setting <code>fastproximity = FALSE</code> allows all models can be compared by AIC.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># shared arguments for model fits 1-4</span></span>
<span><span class="va">timedf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>tfactor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>, tnumeric <span class="op">=</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>capthist <span class="op">=</span> <span class="va">simCH</span>, buffer <span class="op">=</span> <span class="fl">100</span>, biasLimit <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>    timecov <span class="op">=</span> <span class="va">timedf</span>, trace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">g0</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">g0</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">g0</span> <span class="op">~</span> <span class="va">tfactor</span>, <span class="va">g0</span> <span class="op">~</span> <span class="va">tnumeric</span><span class="op">)</span></span>
<span><span class="va">details</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>ignoreusage <span class="op">=</span> <span class="cn">TRUE</span>, fastproximity <span class="op">=</span> </span>
<span>    <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">details</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">ignoreusage</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span></span>
<span><span class="co"># review arguments</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">models</span><span class="op">)</span>, ignoreusage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">details</span>,</span>
<span>    <span class="st">'[['</span>, <span class="st">'ignoreusage'</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          model ignoreusage
1        g0 ~ 1        TRUE
2        g0 ~ 1       FALSE
3  g0 ~ tfactor        TRUE
4 g0 ~ tnumeric        TRUE</code></pre>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># fit</span></span>
<span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="fu">list.secr.fit</span><span class="op">(</span>model <span class="op">=</span> <span class="va">models</span>, details <span class="op">=</span> <span class="va">details</span>, constant <span class="op">=</span> </span>
<span>    <span class="va">args</span>, names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'null'</span>,<span class="st">'usage'</span>,<span class="st">'tfactor'</span>,<span class="st">'tnumeric'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">fits</span><span class="op">)</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           model npar  logLik   dAIC  AICwt
usage           D~1 g0~1 sigma~1    3 -737.20  0.000 0.4212
tnumeric D~1 g0~tnumeric sigma~1    4 -736.24  0.072 0.4063
tfactor   D~1 g0~tfactor sigma~1    5 -736.09  1.785 0.1725
null            D~1 g0~1 sigma~1    3 -744.90 15.390 0.0000</code></pre>
</div>
</div>
<p>From the likelihoods we can see that failure to allow for effort (model ‘null’) dramatically reduces model fit. The model with a factor covariate (‘tfactor’) captures the variation in detection probability, but at the cost of fitting two additional parameters. The model with built-in adjustment for effort (‘usage’) has AIC similar to one with effort as a numeric covariate (‘tnumeric’). How do the estimates compare? This is a task for the <code>collate</code> function.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">collate</span><span class="op">(</span><span class="va">fits</span>, newdata <span class="op">=</span> <span class="va">timedf</span><span class="op">)</span><span class="op">[</span>,,<span class="st">'estimate'</span>,<span class="st">'g0'</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        null   usage tfactor tnumeric
tfactor=1,tnumeric=1 0.21001 0.10112 0.13349  0.12551
tfactor=2,tnumeric=2 0.21001 0.10112 0.18047  0.18851
tfactor=2,tnumeric=2 0.21001 0.10112 0.18047  0.18851
tfactor=3,tnumeric=3 0.21001 0.10112 0.27772  0.27324
tfactor=3,tnumeric=3 0.21001 0.10112 0.27772  0.27324</code></pre>
</div>
</div>
<p>The ‘null’ model fits a single g0 across all occasions that is approximately twice the true rate on occasion 1 (0.1). The estimates of g0 from ‘tfactor’ and ‘tnumeric’ mirror the variation in effort. The effort-adjusted ‘usage’ model estimates the fundamental rate for one unit of effort (0.1).</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">collate</span><span class="op">(</span><span class="va">fits</span><span class="op">)</span><span class="op">[</span>,,,<span class="st">'D'</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         estimate SE.estimate    lcl    ucl
null       4.9709     0.84830 3.5663 6.9287
usage      4.9755     0.84881 3.5700 6.9344
tfactor    4.9703     0.84811 3.5660 6.9277
tnumeric   4.9698     0.84805 3.5656 6.9271</code></pre>
</div>
</div>
<p>The density estimates themselves are almost entirely unaffected by the choice of model for g0. This is not unusual <span class="citation" data-cites="Sollmann2024">(<a href="A99-references.html#ref-Sollmann2024" role="doc-biblioref">Sollmann, 2024</a>)</span>. Nevertheless, the example shows how ‘usage’ allows unbalanced data to be analysed with a minimum of fuss.</p>
</section><section id="further-notes-on-varying-effort" class="level3" data-number="10.3.2"><h3 data-number="10.3.2" class="anchored" data-anchor-id="further-notes-on-varying-effort">
<span class="header-section-number">10.3.2</span> Further notes on varying effort</h3>
<ol type="1">
<li>Adjustment for varying effort will be more critical in analyses where (i) the variation is confounded with temporal (between-session) or spatial variation in density, and (ii) it is important to estimate the temporal or spatial pattern. For example, if detector usage was consistently high in one part of a landscape, while true density was constant, failure to allow for varying usage might produce a spurious density pattern.</li>
<li>The units of usage determine the units of <span class="math inline">g_0</span> or <span class="math inline">\lambda_0</span> in the fitted model. This must be considered when choosing starting values for likelihood maximization. Ordinarily one relies on <code>secr.fit</code> to determine starting values automatically (via <code>autoini</code>), and a simple linear adjustment for usage, averaged across non-zero detectors and occasions, is applied to the value of g0 from <code>autoini</code>.</li>
<li>When occasions are collapsed or detectors are lumped with the <code>reduce</code> method for capthist objects, usage is summed for each aggregated unit.</li>
<li>The function <code>usagePlot</code> displays a bubble plot of spatially varying detector usage on one occasion. The arguments ‘markused’ and ‘markvarying’ of <code>plot.traps</code> may also be useful.</li>
<li>Absolute duration does not always equate with effort. Animal activity may be concentrated in part of the day, or older DNA samples from hair snares may fail to amplify <span class="citation" data-cites="ebm13">(<a href="A99-references.html#ref-ebm13" role="doc-biblioref">Efford et al., 2013</a>)</span>.</li>
<li>Binary or count data from searches of polygons or transects <span class="citation" data-cites="e11">(<a href="A99-references.html#ref-e11" role="doc-biblioref">Efford, 2011</a>)</span> do not raise any new issues for including effort, at least when effort is homogeneous across each polygon or transect. Effects of varying polygon or transect size are automatically accommodated in the models of <a href="04-theory-area-search.html" class="quarto-xref"><span>Chapter 4</span></a>. Models for varying effort within polygons or transects have not been needed for problems encountered to date. Such variation might in any case be accommodated by splitting the searched areas or transects into smaller units that were more nearly homogeneous (see the <code>snip</code> function for splitting transects).</li>
</ol>


<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-1">Figure&nbsp;10.1: Four detection functions fitted to snowshoe hare data.</span>
<span class="glightbox-desc lightbox-desc-2">Figure&nbsp;10.2: Parameter estimates from four detection functions (95% CI).</span>
<span class="glightbox-desc lightbox-desc-3">Figure&nbsp;10.3: HVP function fitted to snowshoe hare data with <span class="math inline">z</span> parameter fixed at four different values.</span>
<span class="glightbox-desc lightbox-desc-4">Figure&nbsp;10.4: Confidence ellipse for HVP detection parameters plotted on the link scale and back-transformed to natural scale. ‘+’ indicates MLE.</span>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-bk14" class="csl-entry" role="listitem">
Borchers, D. L., &amp; Kidney, D. J. (2014). <em>Flexible density surface estimation using regression splines with spatially explicit capture-recapture data</em>. In prep.
</div>
<div id="ref-Borchers2015" class="csl-entry" role="listitem">
Borchers, D. L., Stevenson, B. C., Kidney, D., Thomas, L., &amp; Marques, T. A. (2015). A unifying model for capture–recapture and distance sampling surveys of wildlife populations. <em>Journal of the American Statistical Association</em>, <em>110</em>(509), 195–204. <a href="https://doi.org/10.1080/01621459.2014.893884">https://doi.org/10.1080/01621459.2014.893884</a>
</div>
<div id="ref-bablbt01" class="csl-entry" role="listitem">
Buckland, S. T., Anderson, D. R., Burnham, K. P., Laake, J. L., Borchers, D. L., &amp; Thomas, L. (2001). <em>Introduction to distance sampling</em>. Oxford University Press.
</div>
<div id="ref-Buckland2015" class="csl-entry" role="listitem">
Buckland, S. T., Rexstad, E. A., Marques, T. A., &amp; Oedekoven, C. S. (2015). <em>Distance sampling: Methods and applications</em>. Springer.
</div>
<div id="ref-cw" class="csl-entry" role="listitem">
Cooch, E., &amp; White, G. (Eds.). (2023). <em>Program MARK: A gentle introduction.</em> (23rd ed.). <a href="http://www.phidot.org/software/mark/docs/book/">http://www.phidot.org/software/mark/docs/book/</a>
</div>
<div id="ref-e11" class="csl-entry" role="listitem">
Efford, M. G. (2011). Estimation of population density by spatially explicit capture-recapture analysis of data from area searches. <em>Ecology</em>, <em>92</em>, 2202–2207.
</div>
<div id="ref-ebm13" class="csl-entry" role="listitem">
Efford, M. G., Borchers, D. L., &amp; Mowat, G. (2013). Varying effort in capture-recapture studies. <em>Methods in Ecology and Evolution</em>, <em>4</em>, 629–636.
</div>
<div id="ref-Ergon2013" class="csl-entry" role="listitem">
Ergon, T., &amp; Gardner, B. (2013). Separating mortality and emigration: Modelling space use, dispersal and survival with robust‐design spatial capture–recapture data. <em>Methods in Ecology and Evolution</em>, <em>5</em>(12), 1327–1336. <a href="https://doi.org/10.1111/2041-210x.12133">https://doi.org/10.1111/2041-210x.12133</a>
</div>
<div id="ref-grw09" class="csl-entry" role="listitem">
Gardner, B., Royle, J. A., &amp; Wegan, M. T. (2009). Hierarchical models for estimating density from DNA mark-recapture studies. <em>Ecology</em>, <em>90</em>, 1106–1115.
</div>
<div id="ref-hb83" class="csl-entry" role="listitem">
Hayes, R. J., &amp; Buckland, S. T. (1983). Radial-distance models for the line-transect method. <em>Biometrics</em>, <em>39</em>, 29–42.
</div>
<div id="ref-Kendeigh1944" class="csl-entry" role="listitem">
Kendeigh, S. C. (1944). Measurement of bird populations. <em>Ecological Monographs</em>, <em>14</em>, 67–106. <a href="https://doi.org/10.2307/1961632">https://doi.org/10.2307/1961632</a>
</div>
<div id="ref-obwa78" class="csl-entry" role="listitem">
Otis, D. L., Burnham, K. P., White, G. C., &amp; Anderson, D. R. (1978). Statistical inference from capture data on closed animal populations. <em>Wildlife Monographs</em>, <em>62</em>.
</div>
<div id="ref-rcsg14" class="csl-entry" role="listitem">
Royle, J. A., Chandler, R. B., Sollmann, R., &amp; Gardner, B. (2014). <em>Spatial capture-recapture</em>. Academic Press.
</div>
<div id="ref-Royle2013" class="csl-entry" role="listitem">
Royle, J. A., Chandler, R. B., Sun, C. C., &amp; Fuller, A. K. (2013). Integrating resource selection information with spatial capture–recapture. <em>Methods in Ecology and Evolution</em>, <em>4</em>(6), 520–530. <a href="https://doi.org/10.1111/2041-210x.12039">https://doi.org/10.1111/2041-210x.12039</a>
</div>
<div id="ref-Royle2015" class="csl-entry" role="listitem">
Royle, J. A., Fuller, A. K., &amp; Sutherland, C. (2015). Spatial capture–recapture models allowing markovian transience or dispersal. <em>Population Ecology</em>, <em>58</em>(1), 53–62. <a href="https://doi.org/10.1007/s10144-015-0524-z">https://doi.org/10.1007/s10144-015-0524-z</a>
</div>
<div id="ref-rg11" class="csl-entry" role="listitem">
Royle, J. A., &amp; Gardner, B. (2011). Hierarchical spatial capture-recapture models for estimating density from trapping arrays. In A. F. O’Connell, J. D. Nichols, &amp; K. U. Karanth (Eds.), <em>Camera traps in animal ecology: Methods and analyses</em> (pp. 163–190). Springer.
</div>
<div id="ref-rmgvl11" class="csl-entry" role="listitem">
Royle, J. A., Magoun, A. J., Gardner, B., Valkenburg, P., &amp; Lowell, R. E. (2011). Density estimation in a wolverine population using spatial capture-recapture models. <em>Journal of Wildlife Management</em>, <em>75</em>, 604–611.
</div>
<div id="ref-Sollmann2024" class="csl-entry" role="listitem">
Sollmann, R. (2024). Mt or not mt: Temporal variation in detection probability in spatial capture-recapture and occupancy models. <em>Peer Community Journal</em>, <em>4</em>. <a href="https://doi.org/10.24072/pcjournal.357">https://doi.org/10.24072/pcjournal.357</a>
</div>
<div id="ref-w06" class="csl-entry" role="listitem">
Wood, S. N. (2006). <em>Generalized additive models: An introduction with <span>R</span></em>. Chapman; Hall/CRC.
</div>
</div>
</section></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>The transformation is non-linear so, for example, a half-normal form for <span class="math inline">g(.)</span> does not correspond to half-normal form for <span class="math inline">\lambda(.)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>This use of ‘hazard’ has historical roots in distance sampling <span class="citation" data-cites="hb83">(<a href="A99-references.html#ref-hb83" role="doc-biblioref">Hayes &amp; Buckland, 1983</a>)</span> and has no real connection to models for hazard as a function of distance.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Technically this is the cumulative hazard rather than the instantaneous hazard, but we get tired of using the full term.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>The function <code>list.secr.fit</code> applies <code>secr.fit</code> with multiple settings, in this case different detection functions, and returns an ‘secrlist’, a list of fitted models. <code>list.secr.fit</code> was introduced in <strong>secr</strong> 4.6.6 to replace <code>par.secr.fit</code>.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Examples are <span class="citation" data-cites="grw09">Gardner et al. (<a href="A99-references.html#ref-grw09" role="doc-biblioref">2009</a>)</span>, <span class="citation" data-cites="rg11">Royle &amp; Gardner (<a href="A99-references.html#ref-rg11" role="doc-biblioref">2011</a>)</span> and <span class="citation" data-cites="rmgvl11">Royle et al. (<a href="A99-references.html#ref-rmgvl11" role="doc-biblioref">2011</a>)</span>, but not <span class="citation" data-cites="rcsg14">Royle et al. (<a href="A99-references.html#ref-rcsg14" role="doc-biblioref">2014</a>)</span> and <span class="citation" data-cites="Royle2015">Royle et al. (<a href="A99-references.html#ref-Royle2015" role="doc-biblioref">2015</a>)</span>).<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>In the C++ code, two real-valued 3-dimensional arrays are populated with pre-computed values of <span class="math inline">p_{sk}(\mathbf x)</span> (gk) and <span class="math inline">h_{sk}(\mathbf x)</span> (hk). The dimensions are the number of unique parameter combinations <span class="math inline">C</span>, the number of detectors <span class="math inline">K</span> and the number of mask points <span class="math inline">M</span>. The memory requirement for these arrays alone is <span class="math inline">2.8.C.K.M</span> bytes, which for 200 detectors, 10000 mask points, and 100 parameter levels is 3.2 Gb. This is on top of the two parameter index arrays requiring <span class="math inline">2 . 4 . R. n. S. K. U</span> bytes for <span class="math inline">R</span> sessions and <span class="math inline">U</span> mixture classes (e.g.&nbsp;10 sessions, 200 animals, 6 occasions, 200 detectors and 2 mixture classes, 0.0384 Gb), and a number of smaller objects.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>We use ‘link-linear’ to describe a linear model on the link scale, where this may be log-linear, logit-linear etc.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>The usage matrix for polygon and transect detectors has one row for each polygon or transect, rather than one row per vertex.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="./09-secr-package.html" class="pagination-link" aria-label="R package secr">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">R package secr</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./11-density-model.html" class="pagination-link" aria-label="Density model">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Density model</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>


</body></html>